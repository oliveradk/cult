---

title: Cult Experiments


keywords: fastai
sidebar: home_sidebar



nb_path: "03_experiments.cult_experiments.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 03_experiments.cult_experiments.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">from</span> <span class="nn">cult.core.cult</span> <span class="kn">import</span> <span class="n">CULT</span><span class="p">,</span> <span class="n">CULTTrainer</span>
<span class="kn">from</span> <span class="nn">cult.core.models</span> <span class="kn">import</span> <span class="n">FCEncoder</span><span class="p">,</span> <span class="n">FCDecoder</span>
<span class="kn">from</span> <span class="nn">cult.core.datasets.moving_mnist</span> <span class="kn">import</span> <span class="n">CommonMNIST</span><span class="p">,</span> <span class="n">CommonFashionMNIST</span>
<span class="kn">from</span> <span class="nn">cult.core.utils</span> <span class="kn">import</span> <span class="n">show_batch</span><span class="p">,</span> <span class="n">rec_likelihood</span>
<span class="kn">from</span> <span class="nn">cult.config</span> <span class="kn">import</span> <span class="n">DATA_PATH</span>

<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.data</span> <span class="kn">import</span> <span class="n">DataLoader</span>
<span class="kn">from</span> <span class="nn">torchvision.transforms</span> <span class="kn">import</span> <span class="n">ToTensor</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span> <span class="k">as</span> <span class="n">dt</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">64</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
<span class="n">mnist_train</span> <span class="o">=</span> <span class="n">CommonMNIST</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">())</span>
<span class="n">mnist_test</span> <span class="o">=</span> <span class="n">CommonMNIST</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">())</span>
<span class="n">mnist_train_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">mnist_train</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mnist_test_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">mnist_test</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">mnist_test_batch</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">mnist_test_loader</span><span class="p">)</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>

<span class="n">fashion_train</span> <span class="o">=</span> <span class="n">CommonFashionMNIST</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">())</span>
<span class="n">fashion_test</span> <span class="o">=</span> <span class="n">CommonFashionMNIST</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">())</span>
<span class="n">fashion_train_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">fashion_train</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fashion_test_loader</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">fashion_test</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">fashion_test_batch</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">fashion_test_loader</span><span class="p">)</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="FashionMNIST--%3E-MNIST">FashionMNIST -&gt; MNIST<a class="anchor-link" href="#FashionMNIST--%3E-MNIST"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">kl_scale</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">e_prox_scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#might need to scale?</span>
<span class="n">d_prox_scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#might need to scale</span>
<span class="n">encoder_type</span> <span class="o">=</span> <span class="n">FCEncoder</span>
<span class="n">decoder_type</span> <span class="o">=</span> <span class="n">FCDecoder</span>
<span class="n">final_size</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">latents</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">max_envs</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">atyp_min</span> <span class="o">=</span> <span class="mf">.25</span>
<span class="n">atyp_max</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="n">env_optim</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span>
<span class="n">env_lr</span><span class="o">=</span><span class="mf">1e-4</span>
<span class="n">env_epochs</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#increasing due to poor performance</span>
<span class="n">replay_batch_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">steps_per_save</span> <span class="o">=</span> <span class="mi">2500</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">foo</span> <span class="o">=</span> <span class="n">CULTTrainer</span><span class="p">(</span><span class="s1">&#39;foo&#39;</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">kl_scale</span><span class="p">,</span> <span class="n">e_prox_scale</span><span class="p">,</span> <span class="n">d_prox_scale</span><span class="p">,</span> <span class="n">encoder_type</span><span class="p">,</span> <span class="n">decoder_type</span><span class="p">,</span> <span class="n">final_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">,</span> <span class="n">max_envs</span><span class="p">,</span> <span class="n">atyp_min</span><span class="p">,</span> <span class="n">atyp_max</span><span class="p">,</span> <span class="n">env_optim</span><span class="p">,</span> <span class="n">env_lr</span><span class="p">,</span> <span class="n">env_epochs</span><span class="p">,</span> <span class="n">replay_batch_size</span><span class="p">,</span> <span class="n">steps_per_save</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">foo</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">steps</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">mnist_train_loader</span><span class="p">)</span> <span class="o">*</span> <span class="mi">10</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>9380</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">exp_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">epochs</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;fash_to_mnist_</span><span class="si">{</span><span class="n">exp_num</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">cult_trainer</span> <span class="o">=</span> <span class="n">CULTTrainer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">kl_scale</span><span class="p">,</span> <span class="n">e_prox_scale</span><span class="p">,</span> <span class="n">d_prox_scale</span><span class="p">,</span> <span class="n">encoder_type</span><span class="p">,</span> <span class="n">decoder_type</span><span class="p">,</span> <span class="n">final_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">,</span> <span class="n">max_envs</span><span class="p">,</span> <span class="n">atyp_min</span><span class="p">,</span> <span class="n">atyp_max</span><span class="p">,</span> <span class="n">env_optim</span><span class="p">,</span> <span class="n">env_lr</span><span class="p">,</span> <span class="n">env_epochs</span><span class="p">,</span> <span class="n">replay_batch_size</span><span class="p">,</span> <span class="n">steps_per_save</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">fashion_train_loader</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="p">[</span><span class="n">fashion_test_batch</span><span class="p">,</span> <span class="n">mnist_test_batch</span><span class="p">])</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">mnist_train_loader</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="p">[</span><span class="n">fashion_test_batch</span><span class="p">,</span> <span class="n">mnist_test_batch</span><span class="p">])</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">train_latent_classifiers</span><span class="p">([</span><span class="n">fashion_train_loader</span><span class="p">,</span> <span class="n">mnist_train_loader</span><span class="p">],</span> <span class="p">[</span><span class="n">fashion_test_loader</span><span class="p">,</span> <span class="n">mnist_test_loader</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;fashion_mnist&quot;</span><span class="p">,</span> <span class="s2">&quot;mnist&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">env_net</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">fashion_rec_loss</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">rec_loss</span><span class="p">(</span><span class="n">fashion_test_loader</span><span class="p">)</span>
    <span class="n">mnist_rec_loss</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">rec_loss</span><span class="p">(</span><span class="n">mnist_test_loader</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/fashion_rec_loss&quot;</span><span class="p">,</span> <span class="n">fashion_rec_loss</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/mnist_recc_loss&quot;</span><span class="p">,</span> <span class="n">mnist_rec_loss</span><span class="p">)</span>
    <span class="n">fashion_env_acc</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">env_accuracy</span><span class="p">(</span><span class="n">fashion_test_loader</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">mnist_env_acc</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">env_accuracy</span><span class="p">(</span><span class="n">mnist_test_loader</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/fashion_env_acc&quot;</span><span class="p">,</span> <span class="n">fashion_env_acc</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/mnist_env_acc&quot;</span><span class="p">,</span> <span class="n">mnist_env_acc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0, loss=882.3352661132812, rec_loss=323.55364990234375, total_div_loss=11.868779182434082
epoch: 1, loss=842.9118041992188, rec_loss=280.90960693359375, total_div_loss=15.95385456085205
epoch: 2, loss=833.99072265625, rec_loss=271.1559753417969, total_div_loss=16.97806167602539
epoch: 3, loss=831.0304565429688, rec_loss=267.6246643066406, total_div_loss=17.66572380065918
epoch: 4, loss=829.6016235351562, rec_loss=265.91729736328125, total_div_loss=18.010046005249023
epoch: 5, loss=828.77587890625, rec_loss=264.83648681640625, total_div_loss=18.28383445739746
epoch: 6, loss=827.836669921875, rec_loss=264.0345764160156, total_div_loss=18.204912185668945
epoch: 7, loss=827.3883056640625, rec_loss=263.50250244140625, total_div_loss=18.299375534057617
epoch: 8, loss=827.0670776367188, rec_loss=263.1199951171875, total_div_loss=18.399784088134766
epoch: 9, loss=826.61328125, rec_loss=262.71893310546875, total_div_loss=18.371368408203125
epoch: 0, loss=480.257568359375, rec_loss=180.7962188720703, total_div_loss=11.223749160766602
epoch: 1, loss=463.4721374511719, rec_loss=166.48196411132812, total_div_loss=11.950913429260254
epoch: 2, loss=459.0633239746094, rec_loss=161.16990661621094, total_div_loss=13.168041229248047
epoch: 3, loss=455.5267639160156, rec_loss=158.26902770996094, total_div_loss=13.970429420471191
epoch: 4, loss=454.1923522949219, rec_loss=155.95193481445312, total_div_loss=14.592455863952637
epoch: 5, loss=452.9972229003906, rec_loss=154.64329528808594, total_div_loss=15.095809936523438
epoch: 6, loss=452.40826416015625, rec_loss=153.8228302001953, total_div_loss=15.386085510253906
epoch: 7, loss=451.502685546875, rec_loss=153.05657958984375, total_div_loss=15.550819396972656
epoch: 8, loss=451.2484130859375, rec_loss=152.47164916992188, total_div_loss=15.684959411621094
epoch: 9, loss=451.37640380859375, rec_loss=151.9574737548828, total_div_loss=15.727404594421387
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 7/7 [02:35&lt;00:00, 22.25s/it]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0, loss=881.1354370117188, rec_loss=323.1217956542969, total_div_loss=11.409282684326172
epoch: 1, loss=840.3844604492188, rec_loss=280.5863342285156, total_div_loss=14.154522895812988
epoch: 2, loss=832.8284912109375, rec_loss=272.1751403808594, total_div_loss=15.182563781738281
epoch: 3, loss=830.2005004882812, rec_loss=269.0063171386719, total_div_loss=15.82284164428711
epoch: 4, loss=828.2120971679688, rec_loss=266.6905517578125, total_div_loss=16.234737396240234
epoch: 5, loss=827.1129150390625, rec_loss=265.1929931640625, total_div_loss=16.66802215576172
epoch: 6, loss=826.1986083984375, rec_loss=264.15045166015625, total_div_loss=16.832855224609375
epoch: 7, loss=825.40869140625, rec_loss=263.3125305175781, total_div_loss=16.91683006286621
epoch: 8, loss=825.094482421875, rec_loss=262.8172912597656, total_div_loss=17.133073806762695
epoch: 9, loss=824.730224609375, rec_loss=262.4314880371094, total_div_loss=17.17717933654785
epoch: 0, loss=470.5045166015625, rec_loss=180.0088348388672, total_div_loss=11.536503791809082
epoch: 1, loss=453.14068603515625, rec_loss=164.5802764892578, total_div_loss=12.554841995239258
epoch: 2, loss=448.10614013671875, rec_loss=159.45216369628906, total_div_loss=13.722496032714844
epoch: 3, loss=446.2685241699219, rec_loss=156.7733154296875, total_div_loss=14.399116516113281
epoch: 4, loss=444.85931396484375, rec_loss=155.1386260986328, total_div_loss=14.844923973083496
epoch: 5, loss=443.3915710449219, rec_loss=154.09103393554688, total_div_loss=15.046222686767578
epoch: 6, loss=443.3196716308594, rec_loss=153.1833953857422, total_div_loss=15.306703567504883
epoch: 7, loss=442.7177734375, rec_loss=152.5723419189453, total_div_loss=15.520484924316406
epoch: 8, loss=442.406494140625, rec_loss=152.1327362060547, total_div_loss=15.729125022888184
epoch: 9, loss=442.1541442871094, rec_loss=151.72836303710938, total_div_loss=15.780738830566406
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 7/7 [02:39&lt;00:00, 22.72s/it]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0, loss=881.8001708984375, rec_loss=322.51666259765625, total_div_loss=12.228106498718262
epoch: 1, loss=841.5650024414062, rec_loss=280.15765380859375, total_div_loss=14.926261901855469
epoch: 2, loss=833.6214599609375, rec_loss=271.47430419921875, total_div_loss=15.76183032989502
epoch: 3, loss=830.1779174804688, rec_loss=267.527099609375, total_div_loss=16.33484649658203
epoch: 4, loss=828.6974487304688, rec_loss=265.6979064941406, total_div_loss=16.721275329589844
epoch: 5, loss=827.6818237304688, rec_loss=264.5208435058594, total_div_loss=16.94794273376465
epoch: 6, loss=827.0484008789062, rec_loss=263.6932067871094, total_div_loss=17.18001937866211
epoch: 7, loss=826.3844604492188, rec_loss=262.96099853515625, total_div_loss=17.270259857177734
epoch: 8, loss=826.1036987304688, rec_loss=262.4926452636719, total_div_loss=17.47995948791504
epoch: 9, loss=825.6807250976562, rec_loss=262.0513916015625, total_div_loss=17.549592971801758
epoch: 0, loss=471.3250732421875, rec_loss=178.61634826660156, total_div_loss=11.691905975341797
epoch: 1, loss=454.27874755859375, rec_loss=163.34585571289062, total_div_loss=12.660562515258789
epoch: 2, loss=450.16021728515625, rec_loss=158.43934631347656, total_div_loss=13.77157211303711
epoch: 3, loss=448.535400390625, rec_loss=156.1959228515625, total_div_loss=14.520931243896484
epoch: 4, loss=446.9637756347656, rec_loss=154.67626953125, total_div_loss=14.924477577209473
epoch: 5, loss=446.49560546875, rec_loss=153.51141357421875, total_div_loss=15.34890079498291
epoch: 6, loss=445.5931701660156, rec_loss=152.61642456054688, total_div_loss=15.567792892456055
epoch: 7, loss=444.8638916015625, rec_loss=152.04843139648438, total_div_loss=15.7583646774292
epoch: 8, loss=444.6882019042969, rec_loss=151.5793914794922, total_div_loss=15.883545875549316
epoch: 9, loss=443.50250244140625, rec_loss=151.13461303710938, total_div_loss=15.897793769836426
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 7/7 [02:47&lt;00:00, 23.96s/it]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0, loss=881.3013305664062, rec_loss=322.6269226074219, total_div_loss=12.005391120910645
epoch: 1, loss=840.9617919921875, rec_loss=279.283203125, total_div_loss=15.9032621383667
epoch: 2, loss=833.8262939453125, rec_loss=271.3272705078125, total_div_loss=16.869237899780273
epoch: 3, loss=830.8634643554688, rec_loss=267.99371337890625, total_div_loss=17.312910079956055
epoch: 4, loss=828.9489135742188, rec_loss=265.96630859375, total_div_loss=17.44205665588379
epoch: 5, loss=827.3142700195312, rec_loss=264.4073791503906, total_div_loss=17.378774642944336
epoch: 6, loss=826.317626953125, rec_loss=263.4772644042969, total_div_loss=17.303197860717773
epoch: 7, loss=825.4873657226562, rec_loss=262.6854553222656, total_div_loss=17.28038787841797
epoch: 8, loss=825.0408935546875, rec_loss=262.201171875, total_div_loss=17.330080032348633
epoch: 9, loss=824.6445922851562, rec_loss=261.77069091796875, total_div_loss=17.38921356201172
epoch: 0, loss=472.3203430175781, rec_loss=180.36363220214844, total_div_loss=10.951373100280762
epoch: 1, loss=456.3710632324219, rec_loss=166.51832580566406, total_div_loss=11.355367660522461
epoch: 2, loss=451.2344665527344, rec_loss=160.3104248046875, total_div_loss=12.916444778442383
epoch: 3, loss=448.26123046875, rec_loss=157.20309448242188, total_div_loss=13.91618537902832
epoch: 4, loss=446.2479553222656, rec_loss=154.94129943847656, total_div_loss=14.50240421295166
epoch: 5, loss=445.2660827636719, rec_loss=153.4153594970703, total_div_loss=15.114827156066895
epoch: 6, loss=444.51959228515625, rec_loss=152.4987335205078, total_div_loss=15.407416343688965
epoch: 7, loss=443.2972106933594, rec_loss=151.80897521972656, total_div_loss=15.677643775939941
epoch: 8, loss=443.1138916015625, rec_loss=151.24081420898438, total_div_loss=15.815500259399414
epoch: 9, loss=443.0014953613281, rec_loss=150.8484344482422, total_div_loss=15.97745132446289
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 7/7 [02:40&lt;00:00, 22.92s/it]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="MNIST--%3E-Fashion-MNIST">MNIST -&gt; Fashion MNIST<a class="anchor-link" href="#MNIST--%3E-Fashion-MNIST"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">kl_scale</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">e_prox_scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#might need to scale?</span>
<span class="n">d_prox_scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#might need to scale</span>
<span class="n">encoder_type</span> <span class="o">=</span> <span class="n">FCEncoder</span>
<span class="n">decoder_type</span> <span class="o">=</span> <span class="n">FCDecoder</span>
<span class="n">final_size</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">latents</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">max_envs</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">atyp_min</span> <span class="o">=</span> <span class="mf">.25</span>
<span class="n">atyp_max</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="n">env_optim</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span>
<span class="n">env_lr</span><span class="o">=</span><span class="mf">1e-4</span>
<span class="n">env_epochs</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#increasing due to poor performance</span>
<span class="n">replay_batch_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">steps_per_save</span> <span class="o">=</span> <span class="mi">2500</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">exp_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">epochs</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;mnist_to_fash_</span><span class="si">{</span><span class="n">exp_num</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">cult_trainer</span> <span class="o">=</span> <span class="n">CULTTrainer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">kl_scale</span><span class="p">,</span> <span class="n">e_prox_scale</span><span class="p">,</span> <span class="n">d_prox_scale</span><span class="p">,</span> <span class="n">encoder_type</span><span class="p">,</span> <span class="n">decoder_type</span><span class="p">,</span> <span class="n">final_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">,</span> <span class="n">max_envs</span><span class="p">,</span> <span class="n">atyp_min</span><span class="p">,</span> <span class="n">atyp_max</span><span class="p">,</span> <span class="n">env_optim</span><span class="p">,</span> <span class="n">env_lr</span><span class="p">,</span> <span class="n">env_epochs</span><span class="p">,</span> <span class="n">replay_batch_size</span><span class="p">,</span> <span class="n">steps_per_save</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">mnist_train_loader</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="p">[</span><span class="n">mnist_test_batch</span><span class="p">,</span> <span class="n">fashion_test_batch</span><span class="p">])</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">fashion_train_loader</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="p">[</span><span class="n">mnist_test_batch</span><span class="p">,</span> <span class="n">fashion_test_batch</span><span class="p">])</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">train_latent_classifiers</span><span class="p">([</span><span class="n">mnist_train_loader</span><span class="p">,</span> <span class="n">fashion_train_loader</span><span class="p">],</span> <span class="p">[</span><span class="n">mnist_test_loader</span><span class="p">,</span> <span class="n">fashion_test_loader</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;mnist&quot;</span><span class="p">,</span> <span class="s2">&quot;fashion_mnist&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">fashion_rec_loss</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">rec_loss</span><span class="p">(</span><span class="n">fashion_test_loader</span><span class="p">)</span>
    <span class="n">mnist_rec_loss</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">rec_loss</span><span class="p">(</span><span class="n">mnist_test_loader</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/fashion_rec_loss&quot;</span><span class="p">,</span> <span class="n">fashion_rec_loss</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/mnist_recc_loss&quot;</span><span class="p">,</span> <span class="n">mnist_rec_loss</span><span class="p">)</span>
    <span class="n">fashion_env_acc</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">env_accuracy</span><span class="p">(</span><span class="n">fashion_test_loader</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">mnist_env_acc</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">env_accuracy</span><span class="p">(</span><span class="n">mnist_test_loader</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/fashion_env_acc&quot;</span><span class="p">,</span> <span class="n">fashion_env_acc</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/mnist_env_acc&quot;</span><span class="p">,</span> <span class="n">mnist_env_acc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0, loss=764.3453979492188, rec_loss=210.51756286621094, total_div_loss=6.841984272003174
epoch: 1, loss=728.7280883789062, rec_loss=172.51577758789062, total_div_loss=9.332086563110352
epoch: 2, loss=721.8748168945312, rec_loss=163.42025756835938, total_div_loss=11.954620361328125
epoch: 3, loss=717.7255249023438, rec_loss=158.1334686279297, total_div_loss=13.453836441040039
epoch: 4, loss=715.6884765625, rec_loss=154.83721923828125, total_div_loss=14.420963287353516
epoch: 5, loss=713.866943359375, rec_loss=152.75584411621094, total_div_loss=15.089506149291992
epoch: 6, loss=713.3990478515625, rec_loss=151.5978240966797, total_div_loss=15.527010917663574
epoch: 7, loss=712.3328247070312, rec_loss=150.55862426757812, total_div_loss=15.88389778137207
epoch: 8, loss=711.7504272460938, rec_loss=149.72372436523438, total_div_loss=16.069578170776367
epoch: 9, loss=711.3583984375, rec_loss=149.1879425048828, total_div_loss=16.326169967651367
epoch: 0, loss=492.3997497558594, rec_loss=295.59710693359375, total_div_loss=19.998823165893555
epoch: 1, loss=468.1090393066406, rec_loss=275.50201416015625, total_div_loss=18.17359733581543
epoch: 2, loss=462.1850280761719, rec_loss=270.3234558105469, total_div_loss=17.792945861816406
epoch: 3, loss=458.626708984375, rec_loss=267.8088684082031, total_div_loss=17.36640739440918
epoch: 4, loss=457.0563659667969, rec_loss=266.24969482421875, total_div_loss=17.33355712890625
epoch: 5, loss=455.36297607421875, rec_loss=265.1564025878906, total_div_loss=17.3408203125
epoch: 6, loss=454.03802490234375, rec_loss=264.2576904296875, total_div_loss=17.270145416259766
epoch: 7, loss=453.9687194824219, rec_loss=263.7144470214844, total_div_loss=17.412248611450195
epoch: 8, loss=453.28387451171875, rec_loss=263.26617431640625, total_div_loss=17.42439079284668
epoch: 9, loss=452.87640380859375, rec_loss=262.8715515136719, total_div_loss=17.46509552001953
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|          | 0/7 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.8874)
epoch 1 acc tensor(0.9027)
epoch 2 acc tensor(0.9029)
epoch 0 acc tensor(0.7150)
epoch 1 acc tensor(0.7381)
epoch 2 acc tensor(0.7493)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|█▍        | 1/7 [00:27&lt;02:45, 27.51s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.8864)
epoch 1 acc tensor(0.8962)
epoch 2 acc tensor(0.9002)
epoch 0 acc tensor(0.7235)
epoch 1 acc tensor(0.7386)
epoch 2 acc tensor(0.7509)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|██▊       | 2/7 [00:55&lt;02:17, 27.53s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.8873)
epoch 1 acc tensor(0.8992)
epoch 2 acc tensor(0.8991)
epoch 0 acc tensor(0.6938)
epoch 1 acc tensor(0.6939)
epoch 2 acc tensor(0.7306)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 43%|████▎     | 3/7 [01:22&lt;01:50, 27.65s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.8570)
epoch 1 acc tensor(0.8680)
epoch 2 acc tensor(0.8765)
epoch 0 acc tensor(0.7513)
epoch 1 acc tensor(0.7594)
epoch 2 acc tensor(0.7695)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 57%|█████▋    | 4/7 [01:50&lt;01:22, 27.58s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.8662)
epoch 1 acc tensor(0.8775)
epoch 2 acc tensor(0.8893)
epoch 0 acc tensor(0.7654)
epoch 1 acc tensor(0.7778)
epoch 2 acc tensor(0.7781)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 71%|███████▏  | 5/7 [02:17&lt;00:55, 27.58s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.8643)
epoch 1 acc tensor(0.8754)
epoch 2 acc tensor(0.8842)
epoch 0 acc tensor(0.7666)
epoch 1 acc tensor(0.7676)
epoch 2 acc tensor(0.7767)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 86%|████████▌ | 6/7 [02:45&lt;00:27, 27.62s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.8527)
epoch 1 acc tensor(0.8664)
epoch 2 acc tensor(0.8613)
epoch 0 acc tensor(0.7515)
epoch 1 acc tensor(0.7688)
epoch 2 acc tensor(0.7733)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 7/7 [03:12&lt;00:00, 27.46s/it]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Static-Update:-FashionMNIST--%3E-MNIST">Static Update: FashionMNIST -&gt; MNIST<a class="anchor-link" href="#Static-Update:-FashionMNIST--%3E-MNIST"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">kl_scale</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">e_prox_scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#might need to scale?</span>
<span class="n">d_prox_scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#might need to scale</span>
<span class="n">encoder_type</span> <span class="o">=</span> <span class="n">FCEncoder</span>
<span class="n">decoder_type</span> <span class="o">=</span> <span class="n">FCDecoder</span>
<span class="n">final_size</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">latents</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">max_envs</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">atyp_min</span> <span class="o">=</span> <span class="mf">.25</span>
<span class="n">atyp_max</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="n">env_optim</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span>
<span class="n">env_lr</span><span class="o">=</span><span class="mf">1e-4</span>
<span class="n">env_epochs</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#increasing due to poor performance</span>
<span class="n">replay_batch_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">steps_per_save</span> <span class="o">=</span> <span class="mi">2500</span>
<span class="n">steps_per_reset</span> <span class="o">=</span> <span class="mi">500</span> <span class="c1"># if None, replay model only updated at new environment</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">exp_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">epochs</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;fixed_fash_to_mnist_</span><span class="si">{</span><span class="n">exp_num</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">cult_trainer</span> <span class="o">=</span> <span class="n">CULTTrainer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">kl_scale</span><span class="p">,</span> <span class="n">e_prox_scale</span><span class="p">,</span> <span class="n">d_prox_scale</span><span class="p">,</span> <span class="n">encoder_type</span><span class="p">,</span> <span class="n">decoder_type</span><span class="p">,</span> <span class="n">final_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">,</span> <span class="n">max_envs</span><span class="p">,</span> <span class="n">atyp_min</span><span class="p">,</span> <span class="n">atyp_max</span><span class="p">,</span> <span class="n">env_optim</span><span class="p">,</span> <span class="n">env_lr</span><span class="p">,</span> <span class="n">env_epochs</span><span class="p">,</span> <span class="n">replay_batch_size</span><span class="p">,</span> <span class="n">steps_per_save</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">steps_per_reset</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">fashion_train_loader</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="p">[</span><span class="n">fashion_test_batch</span><span class="p">,</span> <span class="n">mnist_test_batch</span><span class="p">])</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">mnist_train_loader</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="p">[</span><span class="n">fashion_test_batch</span><span class="p">,</span> <span class="n">mnist_test_batch</span><span class="p">])</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">train_latent_classifiers</span><span class="p">([</span><span class="n">fashion_train_loader</span><span class="p">,</span> <span class="n">mnist_train_loader</span><span class="p">],</span> <span class="p">[</span><span class="n">fashion_test_loader</span><span class="p">,</span> <span class="n">mnist_test_loader</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;fashion_mnist&quot;</span><span class="p">,</span> <span class="s2">&quot;mnist&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">fashion_rec_loss</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">rec_loss</span><span class="p">(</span><span class="n">fashion_test_loader</span><span class="p">)</span>
    <span class="n">mnist_rec_loss</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">rec_loss</span><span class="p">(</span><span class="n">mnist_test_loader</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/fashion_rec_loss&quot;</span><span class="p">,</span> <span class="n">fashion_rec_loss</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/mnist_recc_loss&quot;</span><span class="p">,</span> <span class="n">mnist_rec_loss</span><span class="p">)</span>
    <span class="n">fashion_env_acc</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">env_accuracy</span><span class="p">(</span><span class="n">fashion_test_loader</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">mnist_env_acc</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">env_accuracy</span><span class="p">(</span><span class="n">mnist_test_loader</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/fashion_env_acc&quot;</span><span class="p">,</span> <span class="n">fashion_env_acc</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/mnist_env_acc&quot;</span><span class="p">,</span> <span class="n">mnist_env_acc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0, loss=796.3815307617188, rec_loss=321.3736877441406, total_div_loss=13.189351081848145
epoch: 1, loss=614.6005859375, rec_loss=278.6806335449219, total_div_loss=15.87909984588623
epoch: 2, loss=585.7134399414062, rec_loss=270.21435546875, total_div_loss=17.573097229003906
epoch: 3, loss=573.8211059570312, rec_loss=266.4117736816406, total_div_loss=18.862581253051758
epoch: 4, loss=567.7890014648438, rec_loss=264.202880859375, total_div_loss=19.71156883239746
epoch: 5, loss=564.7792358398438, rec_loss=262.7940979003906, total_div_loss=20.17998504638672
epoch: 6, loss=563.1238403320312, rec_loss=261.83990478515625, total_div_loss=20.57794761657715
epoch: 7, loss=561.0931396484375, rec_loss=260.9774169921875, total_div_loss=20.922508239746094
epoch: 8, loss=559.92431640625, rec_loss=260.3429870605469, total_div_loss=21.067846298217773
epoch: 9, loss=558.4791259765625, rec_loss=259.9775695800781, total_div_loss=21.276567459106445
epoch: 0, loss=438.9420166015625, rec_loss=181.1367645263672, total_div_loss=11.46544075012207
epoch: 1, loss=368.29754638671875, rec_loss=165.73521423339844, total_div_loss=12.522045135498047
epoch: 2, loss=349.06451416015625, rec_loss=160.45217895507812, total_div_loss=13.604374885559082
epoch: 3, loss=342.8428955078125, rec_loss=157.21926879882812, total_div_loss=14.476751327514648
epoch: 4, loss=340.2609558105469, rec_loss=155.38978576660156, total_div_loss=15.05983829498291
epoch: 5, loss=338.3412170410156, rec_loss=154.24417114257812, total_div_loss=15.420703887939453
epoch: 6, loss=337.10443115234375, rec_loss=153.44313049316406, total_div_loss=15.573258399963379
epoch: 7, loss=336.7254943847656, rec_loss=152.81092834472656, total_div_loss=15.652820587158203
epoch: 8, loss=335.5625305175781, rec_loss=152.33270263671875, total_div_loss=15.824749946594238
epoch: 9, loss=334.4776306152344, rec_loss=151.79356384277344, total_div_loss=15.92441177368164
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|          | 0/7 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7504)
epoch 1 acc tensor(0.7710)
epoch 2 acc tensor(0.7737)
epoch 0 acc tensor(0.7251)
epoch 1 acc tensor(0.7545)
epoch 2 acc tensor(0.7658)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|█▍        | 1/7 [00:34&lt;03:26, 34.38s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7510)
epoch 1 acc tensor(0.7576)
epoch 2 acc tensor(0.7742)
epoch 0 acc tensor(0.6426)
epoch 1 acc tensor(0.6915)
epoch 2 acc tensor(0.7246)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|██▊       | 2/7 [01:08&lt;02:49, 33.99s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7385)
epoch 1 acc tensor(0.7564)
epoch 2 acc tensor(0.7584)
epoch 0 acc tensor(0.5755)
epoch 1 acc tensor(0.6387)
epoch 2 acc tensor(0.6831)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 43%|████▎     | 3/7 [01:41&lt;02:14, 33.66s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7421)
epoch 1 acc tensor(0.7562)
epoch 2 acc tensor(0.7527)
epoch 0 acc tensor(0.7619)
epoch 1 acc tensor(0.7802)
epoch 2 acc tensor(0.8046)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 57%|█████▋    | 4/7 [02:17&lt;01:44, 34.81s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6962)
epoch 1 acc tensor(0.7165)
epoch 2 acc tensor(0.7103)
epoch 0 acc tensor(0.7873)
epoch 1 acc tensor(0.8254)
epoch 2 acc tensor(0.8329)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 71%|███████▏  | 5/7 [02:53&lt;01:10, 35.13s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7090)
epoch 1 acc tensor(0.7201)
epoch 2 acc tensor(0.7288)
epoch 0 acc tensor(0.8098)
epoch 1 acc tensor(0.8380)
epoch 2 acc tensor(0.8482)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 86%|████████▌ | 6/7 [03:26&lt;00:34, 34.30s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7118)
epoch 1 acc tensor(0.7191)
epoch 2 acc tensor(0.7214)
epoch 0 acc tensor(0.8405)
epoch 1 acc tensor(0.8429)
epoch 2 acc tensor(0.8690)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 7/7 [03:59&lt;00:00, 34.17s/it]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0, loss=792.9951171875, rec_loss=319.96270751953125, total_div_loss=13.596808433532715
epoch: 1, loss=612.5584106445312, rec_loss=277.3134460449219, total_div_loss=16.88612937927246
epoch: 2, loss=586.283203125, rec_loss=267.79473876953125, total_div_loss=19.08025550842285
epoch: 3, loss=575.98095703125, rec_loss=263.74322509765625, total_div_loss=20.563785552978516
epoch: 4, loss=570.0739135742188, rec_loss=261.9313049316406, total_div_loss=21.351295471191406
epoch: 5, loss=566.2647705078125, rec_loss=260.92864990234375, total_div_loss=21.662004470825195
epoch: 6, loss=564.476318359375, rec_loss=260.21148681640625, total_div_loss=21.91639518737793
epoch: 7, loss=562.28173828125, rec_loss=259.67999267578125, total_div_loss=22.056108474731445
epoch: 8, loss=562.007080078125, rec_loss=259.43670654296875, total_div_loss=22.04983139038086
epoch: 9, loss=560.6005249023438, rec_loss=259.2016906738281, total_div_loss=22.048587799072266
epoch: 0, loss=439.66546630859375, rec_loss=179.4946746826172, total_div_loss=11.792529106140137
epoch: 1, loss=367.8169860839844, rec_loss=162.73855590820312, total_div_loss=13.732396125793457
epoch: 2, loss=347.4314270019531, rec_loss=157.3721923828125, total_div_loss=15.089125633239746
epoch: 3, loss=340.5767822265625, rec_loss=155.0181427001953, total_div_loss=15.671631813049316
epoch: 4, loss=336.8040466308594, rec_loss=153.4604034423828, total_div_loss=16.183156967163086
epoch: 5, loss=335.3831481933594, rec_loss=152.31326293945312, total_div_loss=16.75274085998535
epoch: 6, loss=334.57891845703125, rec_loss=151.04232788085938, total_div_loss=17.28708839416504
epoch: 7, loss=332.6568298339844, rec_loss=149.7817840576172, total_div_loss=17.95039176940918
epoch: 8, loss=331.66766357421875, rec_loss=149.11288452148438, total_div_loss=18.50204849243164
epoch: 9, loss=331.5571594238281, rec_loss=148.56480407714844, total_div_loss=18.77239227294922
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|          | 0/7 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7607)
epoch 1 acc tensor(0.7724)
epoch 2 acc tensor(0.7747)
epoch 0 acc tensor(0.7277)
epoch 1 acc tensor(0.7640)
epoch 2 acc tensor(0.7820)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|█▍        | 1/7 [00:32&lt;03:15, 32.60s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7555)
epoch 1 acc tensor(0.7597)
epoch 2 acc tensor(0.7522)
epoch 0 acc tensor(0.6926)
epoch 1 acc tensor(0.7423)
epoch 2 acc tensor(0.7637)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|██▊       | 2/7 [01:03&lt;02:38, 31.62s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7465)
epoch 1 acc tensor(0.7585)
epoch 2 acc tensor(0.7686)
epoch 0 acc tensor(0.6573)
epoch 1 acc tensor(0.7122)
epoch 2 acc tensor(0.7347)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 43%|████▎     | 3/7 [01:37&lt;02:10, 32.56s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7449)
epoch 1 acc tensor(0.7388)
epoch 2 acc tensor(0.7555)
epoch 0 acc tensor(0.7573)
epoch 1 acc tensor(0.7889)
epoch 2 acc tensor(0.7990)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 57%|█████▋    | 4/7 [02:08&lt;01:36, 32.12s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7039)
epoch 1 acc tensor(0.7072)
epoch 2 acc tensor(0.7350)
epoch 0 acc tensor(0.8152)
epoch 1 acc tensor(0.8368)
epoch 2 acc tensor(0.8452)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 71%|███████▏  | 5/7 [02:40&lt;01:04, 32.17s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6869)
epoch 1 acc tensor(0.7182)
epoch 2 acc tensor(0.7152)
epoch 0 acc tensor(0.8003)
epoch 1 acc tensor(0.8351)
epoch 2 acc tensor(0.8482)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 86%|████████▌ | 6/7 [03:12&lt;00:31, 31.89s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6803)
epoch 1 acc tensor(0.6959)
epoch 2 acc tensor(0.7006)
epoch 0 acc tensor(0.8361)
epoch 1 acc tensor(0.8468)
epoch 2 acc tensor(0.8667)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 7/7 [03:43&lt;00:00, 31.98s/it]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0, loss=799.0175170898438, rec_loss=323.5497741699219, total_div_loss=13.428413391113281
epoch: 1, loss=625.6571044921875, rec_loss=281.403076171875, total_div_loss=15.725753784179688
epoch: 2, loss=591.867919921875, rec_loss=271.9954528808594, total_div_loss=16.96068572998047
epoch: 3, loss=578.0994873046875, rec_loss=267.2109069824219, total_div_loss=18.721975326538086
epoch: 4, loss=571.0552978515625, rec_loss=264.64788818359375, total_div_loss=19.840068817138672
epoch: 5, loss=568.2080688476562, rec_loss=262.9278869628906, total_div_loss=20.58833885192871
epoch: 6, loss=565.5624389648438, rec_loss=261.90667724609375, total_div_loss=21.147205352783203
epoch: 7, loss=564.2085571289062, rec_loss=261.1842041015625, total_div_loss=21.437835693359375
epoch: 8, loss=564.1858520507812, rec_loss=260.599365234375, total_div_loss=21.661958694458008
epoch: 9, loss=563.0545043945312, rec_loss=260.226318359375, total_div_loss=21.832435607910156
epoch: 0, loss=444.87078857421875, rec_loss=181.222900390625, total_div_loss=11.715805053710938
epoch: 1, loss=374.9510192871094, rec_loss=163.96926879882812, total_div_loss=13.5864896774292
epoch: 2, loss=352.0189208984375, rec_loss=157.6059112548828, total_div_loss=15.307072639465332
epoch: 3, loss=344.77130126953125, rec_loss=155.31790161132812, total_div_loss=15.845520973205566
epoch: 4, loss=341.6733703613281, rec_loss=153.9956512451172, total_div_loss=16.184743881225586
epoch: 5, loss=339.3549499511719, rec_loss=153.0989532470703, total_div_loss=16.311277389526367
epoch: 6, loss=337.7231140136719, rec_loss=152.39576721191406, total_div_loss=16.71622657775879
epoch: 7, loss=336.1022644042969, rec_loss=151.2499542236328, total_div_loss=16.952911376953125
epoch: 8, loss=334.4479064941406, rec_loss=150.2845001220703, total_div_loss=17.70149803161621
epoch: 9, loss=333.4375, rec_loss=149.49795532226562, total_div_loss=18.093996047973633
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|          | 0/7 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7603)
epoch 1 acc tensor(0.7631)
epoch 2 acc tensor(0.7741)
epoch 0 acc tensor(0.7365)
epoch 1 acc tensor(0.7632)
epoch 2 acc tensor(0.7786)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|█▍        | 1/7 [00:29&lt;02:59, 29.85s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7524)
epoch 1 acc tensor(0.7623)
epoch 2 acc tensor(0.7698)
epoch 0 acc tensor(0.6725)
epoch 1 acc tensor(0.7134)
epoch 2 acc tensor(0.7302)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|██▊       | 2/7 [01:00&lt;02:30, 30.05s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7519)
epoch 1 acc tensor(0.7614)
epoch 2 acc tensor(0.7678)
epoch 0 acc tensor(0.6735)
epoch 1 acc tensor(0.7426)
epoch 2 acc tensor(0.7611)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 43%|████▎     | 3/7 [01:30&lt;02:01, 30.25s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7562)
epoch 1 acc tensor(0.7647)
epoch 2 acc tensor(0.7635)
epoch 0 acc tensor(0.7267)
epoch 1 acc tensor(0.7562)
epoch 2 acc tensor(0.7770)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 57%|█████▋    | 4/7 [02:00&lt;01:30, 30.12s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7062)
epoch 1 acc tensor(0.7185)
epoch 2 acc tensor(0.7335)
epoch 0 acc tensor(0.8109)
epoch 1 acc tensor(0.8352)
epoch 2 acc tensor(0.8365)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 71%|███████▏  | 5/7 [02:31&lt;01:00, 30.28s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6972)
epoch 1 acc tensor(0.7042)
epoch 2 acc tensor(0.7283)
epoch 0 acc tensor(0.8118)
epoch 1 acc tensor(0.8262)
epoch 2 acc tensor(0.8396)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 86%|████████▌ | 6/7 [03:01&lt;00:30, 30.40s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6985)
epoch 1 acc tensor(0.6896)
epoch 2 acc tensor(0.7004)
epoch 0 acc tensor(0.8284)
epoch 1 acc tensor(0.8426)
epoch 2 acc tensor(0.8470)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 7/7 [03:32&lt;00:00, 30.32s/it]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0, loss=793.20849609375, rec_loss=321.2537841796875, total_div_loss=12.790082931518555
epoch: 1, loss=614.8074340820312, rec_loss=282.41998291015625, total_div_loss=13.952102661132812
epoch: 2, loss=586.1149291992188, rec_loss=272.09222412109375, total_div_loss=16.320289611816406
epoch: 3, loss=574.0275268554688, rec_loss=267.81207275390625, total_div_loss=17.821853637695312
epoch: 4, loss=569.130615234375, rec_loss=265.83917236328125, total_div_loss=18.547622680664062
epoch: 5, loss=565.5845947265625, rec_loss=264.33447265625, total_div_loss=19.096376419067383
epoch: 6, loss=563.5015869140625, rec_loss=263.3734436035156, total_div_loss=19.410011291503906
epoch: 7, loss=561.6812133789062, rec_loss=262.6415100097656, total_div_loss=19.672170639038086
epoch: 8, loss=559.5983276367188, rec_loss=262.0635070800781, total_div_loss=19.813867568969727
epoch: 9, loss=559.849609375, rec_loss=261.6167297363281, total_div_loss=20.035024642944336
epoch: 0, loss=439.05218505859375, rec_loss=182.44593811035156, total_div_loss=10.913224220275879
epoch: 1, loss=370.1629333496094, rec_loss=169.06483459472656, total_div_loss=10.7314453125
epoch: 2, loss=352.80572509765625, rec_loss=163.4775848388672, total_div_loss=11.842370986938477
epoch: 3, loss=347.00860595703125, rec_loss=159.67330932617188, total_div_loss=13.16779899597168
epoch: 4, loss=341.9029846191406, rec_loss=157.04624938964844, total_div_loss=14.327427864074707
epoch: 5, loss=338.5080871582031, rec_loss=155.38087463378906, total_div_loss=15.070527076721191
epoch: 6, loss=336.52020263671875, rec_loss=153.6824951171875, total_div_loss=15.737797737121582
epoch: 7, loss=335.0301208496094, rec_loss=151.89964294433594, total_div_loss=16.70904541015625
epoch: 8, loss=332.85870361328125, rec_loss=150.66009521484375, total_div_loss=17.391618728637695
epoch: 9, loss=331.0276794433594, rec_loss=150.01419067382812, total_div_loss=17.84030532836914
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|          | 0/7 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7498)
epoch 1 acc tensor(0.7574)
epoch 2 acc tensor(0.7673)
epoch 0 acc tensor(0.7204)
epoch 1 acc tensor(0.7679)
epoch 2 acc tensor(0.7914)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|█▍        | 1/7 [00:32&lt;03:17, 32.85s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7464)
epoch 1 acc tensor(0.7587)
epoch 2 acc tensor(0.7563)
epoch 0 acc tensor(0.6635)
epoch 1 acc tensor(0.7048)
epoch 2 acc tensor(0.7226)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|██▊       | 2/7 [01:05&lt;02:42, 32.48s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7404)
epoch 1 acc tensor(0.7425)
epoch 2 acc tensor(0.7605)
epoch 0 acc tensor(0.6313)
epoch 1 acc tensor(0.6888)
epoch 2 acc tensor(0.7271)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 43%|████▎     | 3/7 [01:38&lt;02:10, 32.74s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6693)
epoch 1 acc tensor(0.7404)
epoch 2 acc tensor(0.7318)
epoch 0 acc tensor(0.7112)
epoch 1 acc tensor(0.7487)
epoch 2 acc tensor(0.7691)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 57%|█████▋    | 4/7 [02:12&lt;01:40, 33.52s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6896)
epoch 1 acc tensor(0.7132)
epoch 2 acc tensor(0.7209)
epoch 0 acc tensor(0.8029)
epoch 1 acc tensor(0.8299)
epoch 2 acc tensor(0.8366)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 71%|███████▏  | 5/7 [02:49&lt;01:09, 34.59s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7116)
epoch 1 acc tensor(0.7074)
epoch 2 acc tensor(0.7287)
epoch 0 acc tensor(0.8116)
epoch 1 acc tensor(0.8249)
epoch 2 acc tensor(0.8448)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 86%|████████▌ | 6/7 [03:26&lt;00:35, 35.31s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7009)
epoch 1 acc tensor(0.7151)
epoch 2 acc tensor(0.7276)
epoch 0 acc tensor(0.8367)
epoch 1 acc tensor(0.8544)
epoch 2 acc tensor(0.8670)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 7/7 [04:00&lt;00:00, 34.36s/it]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="No-Replay:-FashionMNIST--%3E-MNIST">No Replay: FashionMNIST -&gt; MNIST<a class="anchor-link" href="#No-Replay:-FashionMNIST--%3E-MNIST"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">kl_scale</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">e_prox_scale</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">d_prox_scale</span> <span class="o">=</span> <span class="mi">0</span> 
<span class="n">encoder_type</span> <span class="o">=</span> <span class="n">FCEncoder</span>
<span class="n">decoder_type</span> <span class="o">=</span> <span class="n">FCDecoder</span>
<span class="n">final_size</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">latents</span> <span class="o">=</span> <span class="mi">16</span>
<span class="n">max_envs</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">atyp_min</span> <span class="o">=</span> <span class="mf">.25</span>
<span class="n">atyp_max</span> <span class="o">=</span> <span class="mf">1.4</span>
<span class="n">env_optim</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span>
<span class="n">env_lr</span><span class="o">=</span><span class="mf">1e-4</span>
<span class="n">env_epochs</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">replay_batch_size</span> <span class="o">=</span> <span class="mi">64</span>
<span class="n">steps_per_save</span> <span class="o">=</span> <span class="mi">2500</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">exp_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
    <span class="n">epochs</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;no_replay_fash_to_mnist_</span><span class="si">{</span><span class="n">exp_num</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="n">cult_trainer</span> <span class="o">=</span> <span class="n">CULTTrainer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">,</span> <span class="n">lr</span><span class="p">,</span> <span class="n">kl_scale</span><span class="p">,</span> <span class="n">e_prox_scale</span><span class="p">,</span> <span class="n">d_prox_scale</span><span class="p">,</span> <span class="n">encoder_type</span><span class="p">,</span> <span class="n">decoder_type</span><span class="p">,</span> <span class="n">final_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">,</span> <span class="n">max_envs</span><span class="p">,</span> <span class="n">atyp_min</span><span class="p">,</span> <span class="n">atyp_max</span><span class="p">,</span> <span class="n">env_optim</span><span class="p">,</span> <span class="n">env_lr</span><span class="p">,</span> <span class="n">env_epochs</span><span class="p">,</span> <span class="n">replay_batch_size</span><span class="p">,</span> <span class="n">steps_per_save</span><span class="p">,</span> <span class="n">device</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">fashion_train_loader</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="p">[</span><span class="n">fashion_test_batch</span><span class="p">,</span> <span class="n">mnist_test_batch</span><span class="p">])</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">mnist_train_loader</span><span class="p">,</span> <span class="n">epochs</span><span class="p">,</span> <span class="p">[</span><span class="n">fashion_test_batch</span><span class="p">,</span> <span class="n">mnist_test_batch</span><span class="p">])</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">train_latent_classifiers</span><span class="p">([</span><span class="n">fashion_train_loader</span><span class="p">,</span> <span class="n">mnist_train_loader</span><span class="p">],</span> <span class="p">[</span><span class="n">fashion_test_loader</span><span class="p">,</span> <span class="n">mnist_test_loader</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;fashion_mnist&quot;</span><span class="p">,</span> <span class="s2">&quot;mnist&quot;</span><span class="p">],</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
    <span class="n">fashion_rec_loss</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">rec_loss</span><span class="p">(</span><span class="n">fashion_test_loader</span><span class="p">)</span>
    <span class="n">mnist_rec_loss</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">rec_loss</span><span class="p">(</span><span class="n">mnist_test_loader</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/fashion_rec_loss&quot;</span><span class="p">,</span> <span class="n">fashion_rec_loss</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/mnist_recc_loss&quot;</span><span class="p">,</span> <span class="n">mnist_rec_loss</span><span class="p">)</span>
    <span class="n">fashion_env_acc</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">env_accuracy</span><span class="p">(</span><span class="n">fashion_test_loader</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">mnist_env_acc</span> <span class="o">=</span> <span class="n">cult_trainer</span><span class="o">.</span><span class="n">env_accuracy</span><span class="p">(</span><span class="n">mnist_test_loader</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/fashion_env_acc&quot;</span><span class="p">,</span> <span class="n">fashion_env_acc</span><span class="p">)</span>
    <span class="n">cult_trainer</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="s2">&quot;eval/mnist_env_acc&quot;</span><span class="p">,</span> <span class="n">mnist_env_acc</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0, loss=334.8923034667969, rec_loss=323.24334716796875, total_div_loss=11.648744583129883
epoch: 1, loss=294.34661865234375, rec_loss=280.0571594238281, total_div_loss=14.289599418640137
epoch: 2, loss=285.8857727050781, rec_loss=270.50286865234375, total_div_loss=15.382989883422852
epoch: 3, loss=282.7018127441406, rec_loss=266.8443298339844, total_div_loss=15.857505798339844
epoch: 4, loss=281.1229248046875, rec_loss=264.9488220214844, total_div_loss=16.174055099487305
epoch: 5, loss=280.21435546875, rec_loss=263.57806396484375, total_div_loss=16.636117935180664
epoch: 6, loss=279.5182189941406, rec_loss=262.634765625, total_div_loss=16.883302688598633
epoch: 7, loss=278.9308166503906, rec_loss=261.93914794921875, total_div_loss=16.99139976501465
epoch: 8, loss=278.6372985839844, rec_loss=261.5247802734375, total_div_loss=17.112462997436523
epoch: 9, loss=278.3917541503906, rec_loss=261.1748046875, total_div_loss=17.21686553955078
epoch: 0, loss=184.9942626953125, rec_loss=175.27755737304688, total_div_loss=9.716602325439453
epoch: 1, loss=170.91949462890625, rec_loss=159.07554626464844, total_div_loss=11.843913078308105
epoch: 2, loss=168.47381591796875, rec_loss=155.603271484375, total_div_loss=12.87045669555664
epoch: 3, loss=167.3048858642578, rec_loss=153.8844451904297, total_div_loss=13.42044734954834
epoch: 4, loss=166.50534057617188, rec_loss=152.67506408691406, total_div_loss=13.830455780029297
epoch: 5, loss=166.09523010253906, rec_loss=151.89747619628906, total_div_loss=14.197912216186523
epoch: 6, loss=165.51461791992188, rec_loss=151.04029846191406, total_div_loss=14.474360466003418
epoch: 7, loss=165.23318481445312, rec_loss=150.49977111816406, total_div_loss=14.733624458312988
epoch: 8, loss=165.04852294921875, rec_loss=149.973876953125, total_div_loss=15.07473373413086
epoch: 9, loss=164.6261444091797, rec_loss=149.41262817382812, total_div_loss=15.213436126708984
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|          | 0/7 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7438)
epoch 1 acc tensor(0.7671)
epoch 2 acc tensor(0.7724)
epoch 0 acc tensor(0.7176)
epoch 1 acc tensor(0.7701)
epoch 2 acc tensor(0.7757)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|█▍        | 1/7 [00:23&lt;02:23, 23.99s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7400)
epoch 1 acc tensor(0.7533)
epoch 2 acc tensor(0.7582)
epoch 0 acc tensor(0.6762)
epoch 1 acc tensor(0.7087)
epoch 2 acc tensor(0.7198)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|██▊       | 2/7 [00:48&lt;02:01, 24.25s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7527)
epoch 1 acc tensor(0.7448)
epoch 2 acc tensor(0.7718)
epoch 0 acc tensor(0.6611)
epoch 1 acc tensor(0.6954)
epoch 2 acc tensor(0.7018)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 43%|████▎     | 3/7 [01:12&lt;01:37, 24.34s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7369)
epoch 1 acc tensor(0.7543)
epoch 2 acc tensor(0.7599)
epoch 0 acc tensor(0.7442)
epoch 1 acc tensor(0.7602)
epoch 2 acc tensor(0.7647)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 57%|█████▋    | 4/7 [01:37&lt;01:13, 24.54s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7206)
epoch 1 acc tensor(0.7317)
epoch 2 acc tensor(0.7386)
epoch 0 acc tensor(0.8041)
epoch 1 acc tensor(0.8213)
epoch 2 acc tensor(0.8309)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 71%|███████▏  | 5/7 [02:01&lt;00:48, 24.28s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6983)
epoch 1 acc tensor(0.7223)
epoch 2 acc tensor(0.7194)
epoch 0 acc tensor(0.8107)
epoch 1 acc tensor(0.8187)
epoch 2 acc tensor(0.8291)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 86%|████████▌ | 6/7 [02:25&lt;00:24, 24.24s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6768)
epoch 1 acc tensor(0.6930)
epoch 2 acc tensor(0.6768)
epoch 0 acc tensor(0.8200)
epoch 1 acc tensor(0.8334)
epoch 2 acc tensor(0.8406)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 7/7 [02:49&lt;00:00, 24.18s/it]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0, loss=333.8553466796875, rec_loss=321.3582763671875, total_div_loss=12.49676513671875
epoch: 1, loss=293.4124450683594, rec_loss=278.4168395996094, total_div_loss=14.995670318603516
epoch: 2, loss=285.5057678222656, rec_loss=269.786376953125, total_div_loss=15.719441413879395
epoch: 3, loss=282.064697265625, rec_loss=265.8401184082031, total_div_loss=16.224658966064453
epoch: 4, loss=280.67620849609375, rec_loss=264.04620361328125, total_div_loss=16.630428314208984
epoch: 5, loss=279.7281494140625, rec_loss=263.00335693359375, total_div_loss=16.724855422973633
epoch: 6, loss=279.21051025390625, rec_loss=262.27008056640625, total_div_loss=16.94050407409668
epoch: 7, loss=278.77838134765625, rec_loss=261.748779296875, total_div_loss=17.02937126159668
epoch: 8, loss=278.4950256347656, rec_loss=261.3277282714844, total_div_loss=17.167144775390625
epoch: 9, loss=278.161376953125, rec_loss=260.97271728515625, total_div_loss=17.18875503540039
epoch: 0, loss=183.8594970703125, rec_loss=173.80618286132812, total_div_loss=10.053396224975586
epoch: 1, loss=170.66159057617188, rec_loss=158.62796020507812, total_div_loss=12.033705711364746
epoch: 2, loss=168.2733917236328, rec_loss=155.3400421142578, total_div_loss=12.933398246765137
epoch: 3, loss=167.01205444335938, rec_loss=153.37649536132812, total_div_loss=13.635687828063965
epoch: 4, loss=166.1302032470703, rec_loss=151.848876953125, total_div_loss=14.281246185302734
epoch: 5, loss=165.45216369628906, rec_loss=150.82705688476562, total_div_loss=14.625222206115723
epoch: 6, loss=164.91824340820312, rec_loss=149.9072723388672, total_div_loss=15.010995864868164
epoch: 7, loss=164.3751983642578, rec_loss=149.02671813964844, total_div_loss=15.348566055297852
epoch: 8, loss=163.99905395507812, rec_loss=148.46717834472656, total_div_loss=15.531923294067383
epoch: 9, loss=163.8610382080078, rec_loss=148.1495361328125, total_div_loss=15.7116117477417
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|          | 0/7 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7547)
epoch 1 acc tensor(0.7772)
epoch 2 acc tensor(0.7773)
epoch 0 acc tensor(0.7487)
epoch 1 acc tensor(0.7909)
epoch 2 acc tensor(0.8000)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|█▍        | 1/7 [00:25&lt;02:35, 25.94s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7563)
epoch 1 acc tensor(0.7614)
epoch 2 acc tensor(0.7735)
epoch 0 acc tensor(0.6741)
epoch 1 acc tensor(0.7110)
epoch 2 acc tensor(0.7453)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|██▊       | 2/7 [00:51&lt;02:10, 26.00s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7567)
epoch 1 acc tensor(0.7628)
epoch 2 acc tensor(0.7712)
epoch 0 acc tensor(0.6838)
epoch 1 acc tensor(0.7301)
epoch 2 acc tensor(0.7608)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 43%|████▎     | 3/7 [01:17&lt;01:43, 25.88s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7373)
epoch 1 acc tensor(0.7540)
epoch 2 acc tensor(0.7439)
epoch 0 acc tensor(0.7646)
epoch 1 acc tensor(0.7916)
epoch 2 acc tensor(0.8103)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 57%|█████▋    | 4/7 [01:43&lt;01:17, 25.83s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7116)
epoch 1 acc tensor(0.7388)
epoch 2 acc tensor(0.7372)
epoch 0 acc tensor(0.8000)
epoch 1 acc tensor(0.8235)
epoch 2 acc tensor(0.8371)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 71%|███████▏  | 5/7 [02:09&lt;00:51, 25.95s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6789)
epoch 1 acc tensor(0.7220)
epoch 2 acc tensor(0.7172)
epoch 0 acc tensor(0.8159)
epoch 1 acc tensor(0.8246)
epoch 2 acc tensor(0.8361)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 86%|████████▌ | 6/7 [02:36&lt;00:26, 26.30s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6945)
epoch 1 acc tensor(0.7416)
epoch 2 acc tensor(0.7449)
epoch 0 acc tensor(0.8422)
epoch 1 acc tensor(0.8495)
epoch 2 acc tensor(0.8605)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 7/7 [03:03&lt;00:00, 26.21s/it]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0, loss=336.777587890625, rec_loss=325.4460144042969, total_div_loss=11.33141040802002
epoch: 1, loss=293.6722106933594, rec_loss=278.96771240234375, total_div_loss=14.704360961914062
epoch: 2, loss=285.90093994140625, rec_loss=270.6869812011719, total_div_loss=15.21430492401123
epoch: 3, loss=283.06939697265625, rec_loss=267.1966552734375, total_div_loss=15.872753143310547
epoch: 4, loss=281.513427734375, rec_loss=265.2506408691406, total_div_loss=16.26283836364746
epoch: 5, loss=280.5991516113281, rec_loss=264.10980224609375, total_div_loss=16.48932456970215
epoch: 6, loss=280.1010437011719, rec_loss=263.3803405761719, total_div_loss=16.720712661743164
epoch: 7, loss=279.6591796875, rec_loss=262.89306640625, total_div_loss=16.765905380249023
epoch: 8, loss=279.28265380859375, rec_loss=262.40655517578125, total_div_loss=16.87615394592285
epoch: 9, loss=279.1617736816406, rec_loss=262.15960693359375, total_div_loss=17.00200843811035
epoch: 0, loss=185.7779541015625, rec_loss=176.07810974121094, total_div_loss=9.69997787475586
epoch: 1, loss=171.9030303955078, rec_loss=160.077880859375, total_div_loss=11.82509708404541
epoch: 2, loss=168.8349151611328, rec_loss=155.49720764160156, total_div_loss=13.337774276733398
epoch: 3, loss=167.34051513671875, rec_loss=153.29287719726562, total_div_loss=14.0477294921875
epoch: 4, loss=166.32846069335938, rec_loss=151.7774658203125, total_div_loss=14.551054000854492
epoch: 5, loss=165.7513885498047, rec_loss=150.79383850097656, total_div_loss=14.95751667022705
epoch: 6, loss=165.12542724609375, rec_loss=149.94361877441406, total_div_loss=15.181852340698242
epoch: 7, loss=164.78773498535156, rec_loss=149.38668823242188, total_div_loss=15.400900840759277
epoch: 8, loss=164.49562072753906, rec_loss=148.91348266601562, total_div_loss=15.582066535949707
epoch: 9, loss=164.04983520507812, rec_loss=148.3675994873047, total_div_loss=15.682357788085938
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|          | 0/7 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7570)
epoch 1 acc tensor(0.7718)
epoch 2 acc tensor(0.7689)
epoch 0 acc tensor(0.6807)
epoch 1 acc tensor(0.7272)
epoch 2 acc tensor(0.7463)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|█▍        | 1/7 [00:24&lt;02:26, 24.35s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7589)
epoch 1 acc tensor(0.7738)
epoch 2 acc tensor(0.7761)
epoch 0 acc tensor(0.6771)
epoch 1 acc tensor(0.7269)
epoch 2 acc tensor(0.7464)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|██▊       | 2/7 [00:49&lt;02:02, 24.58s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7572)
epoch 1 acc tensor(0.7675)
epoch 2 acc tensor(0.7742)
epoch 0 acc tensor(0.6775)
epoch 1 acc tensor(0.7209)
epoch 2 acc tensor(0.7472)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 43%|████▎     | 3/7 [01:13&lt;01:38, 24.51s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7554)
epoch 1 acc tensor(0.7620)
epoch 2 acc tensor(0.7733)
epoch 0 acc tensor(0.7784)
epoch 1 acc tensor(0.7988)
epoch 2 acc tensor(0.8043)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 57%|█████▋    | 4/7 [01:37&lt;01:13, 24.38s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7479)
epoch 1 acc tensor(0.7524)
epoch 2 acc tensor(0.7585)
epoch 0 acc tensor(0.8032)
epoch 1 acc tensor(0.8389)
epoch 2 acc tensor(0.8439)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 71%|███████▏  | 5/7 [02:02&lt;00:48, 24.37s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7125)
epoch 1 acc tensor(0.7091)
epoch 2 acc tensor(0.7312)
epoch 0 acc tensor(0.8313)
epoch 1 acc tensor(0.8349)
epoch 2 acc tensor(0.8495)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 86%|████████▌ | 6/7 [02:27&lt;00:24, 24.64s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6988)
epoch 1 acc tensor(0.7069)
epoch 2 acc tensor(0.7262)
epoch 0 acc tensor(0.8187)
epoch 1 acc tensor(0.8307)
epoch 2 acc tensor(0.8460)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 7/7 [02:52&lt;00:00, 24.69s/it]
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch: 0, loss=335.5830078125, rec_loss=323.99481201171875, total_div_loss=11.588252067565918
epoch: 1, loss=294.2428894042969, rec_loss=279.83026123046875, total_div_loss=14.412590980529785
epoch: 2, loss=285.54644775390625, rec_loss=270.1600036621094, total_div_loss=15.386816024780273
epoch: 3, loss=282.3013000488281, rec_loss=266.130615234375, total_div_loss=16.170581817626953
epoch: 4, loss=280.7105407714844, rec_loss=264.1639709472656, total_div_loss=16.5465030670166
epoch: 5, loss=280.0584716796875, rec_loss=263.1952209472656, total_div_loss=16.86334800720215
epoch: 6, loss=279.4309387207031, rec_loss=262.504150390625, total_div_loss=16.926692962646484
epoch: 7, loss=278.8711242675781, rec_loss=261.8187561035156, total_div_loss=17.052818298339844
epoch: 8, loss=278.6446533203125, rec_loss=261.4794921875, total_div_loss=17.165231704711914
epoch: 9, loss=278.4310302734375, rec_loss=261.1632080078125, total_div_loss=17.267921447753906
epoch: 0, loss=183.92221069335938, rec_loss=173.5866241455078, total_div_loss=10.335838317871094
epoch: 1, loss=170.62754821777344, rec_loss=158.58139038085938, total_div_loss=12.04616641998291
epoch: 2, loss=168.31466674804688, rec_loss=155.373779296875, total_div_loss=12.940956115722656
epoch: 3, loss=167.23118591308594, rec_loss=153.6739501953125, total_div_loss=13.557137489318848
epoch: 4, loss=166.39451599121094, rec_loss=152.3918914794922, total_div_loss=14.00265884399414
epoch: 5, loss=165.76904296875, rec_loss=151.34353637695312, total_div_loss=14.425576210021973
epoch: 6, loss=165.2182159423828, rec_loss=150.49505615234375, total_div_loss=14.723072052001953
epoch: 7, loss=164.8876495361328, rec_loss=149.9463348388672, total_div_loss=14.94133472442627
epoch: 8, loss=164.45115661621094, rec_loss=149.24032592773438, total_div_loss=15.210813522338867
epoch: 9, loss=164.1199951171875, rec_loss=148.79000854492188, total_div_loss=15.330044746398926
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>  0%|          | 0/7 [00:00&lt;?, ?it/s]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7707)
epoch 1 acc tensor(0.7750)
epoch 2 acc tensor(0.7849)
epoch 0 acc tensor(0.7189)
epoch 1 acc tensor(0.7662)
epoch 2 acc tensor(0.7794)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 14%|█▍        | 1/7 [00:26&lt;02:36, 26.09s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7513)
epoch 1 acc tensor(0.7613)
epoch 2 acc tensor(0.7779)
epoch 0 acc tensor(0.6728)
epoch 1 acc tensor(0.7044)
epoch 2 acc tensor(0.7329)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 29%|██▊       | 2/7 [00:52&lt;02:10, 26.09s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7584)
epoch 1 acc tensor(0.7690)
epoch 2 acc tensor(0.7650)
epoch 0 acc tensor(0.6922)
epoch 1 acc tensor(0.7157)
epoch 2 acc tensor(0.7537)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 43%|████▎     | 3/7 [01:18&lt;01:44, 26.18s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.7439)
epoch 1 acc tensor(0.7599)
epoch 2 acc tensor(0.7637)
epoch 0 acc tensor(0.7560)
epoch 1 acc tensor(0.7798)
epoch 2 acc tensor(0.7954)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 57%|█████▋    | 4/7 [01:44&lt;01:18, 26.27s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6857)
epoch 1 acc tensor(0.7162)
epoch 2 acc tensor(0.7201)
epoch 0 acc tensor(0.8126)
epoch 1 acc tensor(0.8308)
epoch 2 acc tensor(0.8403)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 71%|███████▏  | 5/7 [02:13&lt;00:54, 27.03s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6866)
epoch 1 acc tensor(0.7004)
epoch 2 acc tensor(0.7146)
epoch 0 acc tensor(0.8242)
epoch 1 acc tensor(0.8321)
epoch 2 acc tensor(0.8402)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre> 86%|████████▌ | 6/7 [02:38&lt;00:26, 26.54s/it]</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>epoch 0 acc tensor(0.6695)
epoch 1 acc tensor(0.6858)
epoch 2 acc tensor(0.6897)
epoch 0 acc tensor(0.8254)
epoch 1 acc tensor(0.8383)
epoch 2 acc tensor(0.8448)
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>100%|██████████| 7/7 [03:04&lt;00:00, 26.41s/it]
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

</div>


