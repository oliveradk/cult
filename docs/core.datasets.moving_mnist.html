---

title: Moving MNIST


keywords: fastai
sidebar: home_sidebar

summary: "Here we define varients of MNIST and Fashion MNIST with the location of the objects varied"
description: "Here we define varients of MNIST and Fashion MNIST with the location of the objects varied"
nb_path: "01a_core.datasets.moving_mnist.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 01a_core.datasets.moving_mnist.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Common-MNIST/FashionMNIST">Common MNIST/FashionMNIST<a class="anchor-link" href="#Common-MNIST/FashionMNIST"> </a></h2><p>The pytorch version of MNIST stored data according to the class name - so to allow for classes to inheret from MNIST without downloading the same dataset to multiple directories, we'll override the the original pytorch MNIST as follows:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CommonMNIST" class="doc_header"><code>class</code> <code>CommonMNIST</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/datasets/moving_mnist.py#L16" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CommonMNIST</code>(<strong><code>root</code></strong>:<code>str</code>, <strong><code>train</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>transform</code></strong>:<code>Optional</code>[<code>typing.Callable</code>]=<em><code>None</code></em>, <strong><code>target_transform</code></strong>:<code>Optional</code>[<code>typing.Callable</code>]=<em><code>None</code></em>, <strong><code>download</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <code>MNIST</code></p>
</blockquote>
<p>MNIST where data path is fixed</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CommonFashionMNIST" class="doc_header"><code>class</code> <code>CommonFashionMNIST</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/datasets/moving_mnist.py#L30" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CommonFashionMNIST</code>(<strong><code>root</code></strong>:<code>str</code>, <strong><code>train</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>transform</code></strong>:<code>Optional</code>[<code>typing.Callable</code>]=<em><code>None</code></em>, <strong><code>target_transform</code></strong>:<code>Optional</code>[<code>typing.Callable</code>]=<em><code>None</code></em>, <strong><code>download</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <code>FashionMNIST</code></p>
</blockquote>
<p>FashionMNIST where data path is fixed</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Explore-MNIST-and-Fashion-MNIST">Explore MNIST and Fashion MNIST<a class="anchor-link" href="#Explore-MNIST-and-Fashion-MNIST"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mnist</span> <span class="o">=</span> <span class="n">CommonMNIST</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mnist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAABAElEQVR4nGNgGMyAWUhIqK5jvdSy/9/rGRgYGFhgEnJsVjYCwQwMDAxPJgV+vniQgYGBgREqZ7iXH8r6l/SV4dn7m8gmCt3++/fv37/Htn3/iMW+gDnZf/+e5WbQnoXNNXyMs/5GoQoxwVmf/n9kSGFiwAW49/11wynJoPzx4YIcRlyygR/+/i2XxCWru+vv32nSuGQFYv/83Y3b4p9/fzpAmSyoMnohpiwM1w5h06Q+5enfv39/bcMiJVF09+/fv39P+mFKiTtd/fv3799jgZiBJLT69t+/f/8eDuDEkDJf8+jv379/v7Ryo4qzMDAwMAQGMjBc3/y35wM2V1IfAABFF16Aa0wAOwAAAABJRU5ErkJggg=="
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mnist</span> <span class="o">=</span> <span class="n">CommonMNIST</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">())</span>
<span class="n">mnist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([1, 28, 28])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fashion_mnist</span> <span class="o">=</span> <span class="n">FashionMNIST</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fashion_mnist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACBUlEQVR4nLXSz0tUURQH8O+597373rx545g6NmNJY6TlJgozEsKFZGCrkDBoVdGmdf9BiwJ3bVr1PwhBUbQfJQcKjWZRTsjo0KDpDPV+eN+997WK0Z2bvtsPfM+Bc4D/HwJycwBZAEAE6zAyfe5RFMQfFYiRAj+CXM/c2HK82VetVMM34RGUmCxz9v7yYnW9dnWyskyHR6azi72Jwep3ScVk9c7LLhKQrpRBSiI2n76puZFT3doUwH4pcmw/zpjrU2zw3dFt4XEWdvbKhpinzTBYt5bDH4qlLYO8cbKBWHOudDHluFtiLrLD0kmM2//6q9VFS+JLLDxv9GzMPV9v3XuzYgHEGSUGCngbRCLd4W6CxPCLHTDwVMkDA0y/qEa/lFFBoF2EEME8CAD6hsZK8+djlmSatuiXXsWfNh27NU6Yelro1bytPElRbaGaO1FGPfc7zPg9HvHlIaVD8AjID9y/+bgZ/6iP9ks7J/QZevh8w/cd2PlGs8CKt92R7MQEk0yA7GtWq9ETN3zRs7fpR7FaWi/3yXaipW1IjFnbaSM70N7dsRzbzbHd8aCx7+wmKskUO5esz0sPmvXYF67gBzoNfxptxb5stxM10iLg1pOTO23NhcUptW1hE6gFYYprC8QMMPNsMM+4pamVbps/HGkSsg+1Cv4d+0Jh//Sm3DjGix4rfwFoJNh2/0cDFgAAAABJRU5ErkJggg=="
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fashion_mnist</span> <span class="o">=</span> <span class="n">FashionMNIST</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ToTensor</span><span class="p">())</span>
<span class="n">fashion_mnist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([1, 28, 28])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Moving-MNSIT/Fashion-MNIST">Moving MNSIT/Fashion MNIST<a class="anchor-link" href="#Moving-MNSIT/Fashion-MNIST"> </a></h2><p>The original <a href="http://www.cs.toronto.edu/~nitish/unsupervised_video/">moving MNIST</a> uses a 64x64 background, which Aachilles et al also seems to use:</p>
<p><code>For the encoder we use a simple convolutional network with the following structure:
conv 64 â†’ ...</code></p>
<p>Since the MNIST and FashionMNIST are 28x28, that leaves a 36x36 possible locations for each image</p>
<p>To generate the "Moving" datasets, the location of each image will be randomly sampled and stitched onto a black background each time <code>__getitem__</code> is called</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Exploration">Exploration<a class="anchor-link" href="#Exploration"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dst</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">))</span>
<span class="n">dst</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAAAAACPAi4CAAAAG0lEQVR4nO3BgQAAAADDoPlT3+AEVQEAAAB8AxBAAAFGOA0dAAAAAElFTkSuQmCC"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fashion_mnist</span> <span class="o">=</span> <span class="n">FashionMNIST</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">fashion_mnist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">img</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAACBUlEQVR4nLXSz0tUURQH8O+597373rx545g6NmNJY6TlJgozEsKFZGCrkDBoVdGmdf9BiwJ3bVr1PwhBUbQfJQcKjWZRTsjo0KDpDPV+eN+997WK0Z2bvtsPfM+Bc4D/HwJycwBZAEAE6zAyfe5RFMQfFYiRAj+CXM/c2HK82VetVMM34RGUmCxz9v7yYnW9dnWyskyHR6azi72Jwep3ScVk9c7LLhKQrpRBSiI2n76puZFT3doUwH4pcmw/zpjrU2zw3dFt4XEWdvbKhpinzTBYt5bDH4qlLYO8cbKBWHOudDHluFtiLrLD0kmM2//6q9VFS+JLLDxv9GzMPV9v3XuzYgHEGSUGCngbRCLd4W6CxPCLHTDwVMkDA0y/qEa/lFFBoF2EEME8CAD6hsZK8+djlmSatuiXXsWfNh27NU6Yelro1bytPElRbaGaO1FGPfc7zPg9HvHlIaVD8AjID9y/+bgZ/6iP9ks7J/QZevh8w/cd2PlGs8CKt92R7MQEk0yA7GtWq9ETN3zRs7fpR7FaWi/3yXaipW1IjFnbaSM70N7dsRzbzbHd8aCx7+wmKskUO5esz0sPmvXYF67gBzoNfxptxb5stxM10iLg1pOTO23NhcUptW1hE6gFYYprC8QMMPNsMM+4pamVbps/HGkSsg+1Cv4d+0Jh//Sm3DjGix4rfwFoJNh2/0cDFgAAAABJRU5ErkJggg=="
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dst</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
<span class="n">dst</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAAAAACPAi4CAAACOklEQVR4nO3Uz0sUYQDG8ed935l3ZmdnXfNXqyWtkZaXKMxICA+SgZ1CwqCTRZfO/QcdCrx16dT/IARFEXVUSaHQyENpyOrSoukuNT98533f6SYGEe/eIuZ7mjk8H+YdhgH+rwhQmACIBQCEGG2swzdUnbobBfE7CUKJBFPNAkyNXdl0vPGntVTB12HTTyAwXGb01fmZpZXVi8Nz8w0D4PBBSTo+05poLH4RpJQs3njytimAAOlCGUQKxPr9ZznRd6y5I6QA9rojx/bjnL48Qrtemux/fwfwGA0bu2VNqKd0rxFAD64Ig98TC1sERe3kA77sXGgOSBludlMX+V7hJNptf/bJ+svuD4Al8DHmntd/MmaerzZvPV8wASyAMEoSDQm8CCKebjM3QaLZWZOvAKBgqRT7Ghh9vBR9l1oGgXIRggeTRgABgLaege7J0zFNclWbtwtvzh/VDbs2aAaMPOhsVawuPUGi1amlwpEy1gs/wpzf4hkBbL5HqhAsAood01fvVeOv6/3twi5wdcIIuPNozfcd2MVKtZOWrrt9+aEhKigHsS9VDACrVmmJKz5v2d3wo1jOrpTbRD1RwtaEDxgBW2kl31Hf2bYc2y3QncGgsufsJDLJlRrn3pgAH2ZvV9djn7uc7as0/KaVFfuiXk9kX81gDwJcu390u64YtxhJbZvbBKQGrkvLU0YA1cDYw64iZZYitXRL/2RIk5C+Xp0z2R/8UM507h3fEGtGm6ysrKysrKysrH++X22P3aXZ/GOFAAAAAElFTkSuQmCC"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dst</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">dst</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAAAAACPAi4CAAACeUlEQVR4nO2Uz0sUYRjHv+/7zq+dnXXNX62WtEZaXqIwIyE8SAZ2CgmDThVdOvcfdCjw1qVT/4MQFEXUUSWFQiMPpSGrS4umu9TsTO/M+04HXXd1psFjxHyv83k+7/M88/IC/1cIkBkDiAIAhBwKURq/UnHqnmO7730QSnwwERaEkH0CJkaurOnm6LNSIGDJakQHIWSfgGMwz+jr85Pzi0sXB6dnKmFBCGkclASjk82exNxXTnLe3I2n78IrCCF1AQGC2TyIz+HKD1/8sZ5jERsMIfURAgDbnY6uWm5KXh6iHa9C50ch+3YAk9FqZSsvCTWF7I7YYRih9f4YrC6Xq9zOSj1tawv6hdAIEUhdEDDc7KQG0t1c96TR+vyzclAQhdQFCscnVzPN3pMuMy2xduvF7EFBFKIAhFHiSfjAS9vRgg1mePAkO9twC2IQChb4/LcEhp/MOz986du2MFCFZo/v1cchBABauvo6x0+71EsVVa2Vm9PWsKyopf6G7v+KEAw9bG8WrOybnDhLE/OZI3msZH5WU1aTWauOQwib6fJFFcwBsm23r94vut9Welu5mtHEidoEcQi5+3jZsnSo2UKxneauGz3pgQHKqQaiXirsCGIRpVRocguW1rS1ajmuP7WYb+FlT3BVEq1vVxCLKOtBId1W3txQdNXI0M1+u7Ctb3q+l8pVzr3dEcQiysepO8UV19IMjf0WQfW7FIpr8XLZ83tKuzuIRQhw7cHRjbJgmsJIoKqaSkBK0GRuYWLvJ8YghEpg5FFHljJFkFKwLn8xBF6VvlmarpXHIrUH5Uz79vFVvnzw9jfmEEiSJEmSJEmSJEmSfyR/ANgBuyMFq8U9AAAAAElFTkSuQmCC"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">dst</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">35</span><span class="p">])</span>
<span class="n">dst</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mi">35</span><span class="p">])</span>
<span class="n">dst</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAAAAACPAi4CAAACg0lEQVR4nO2Wz0sUYRjHv+/7zq+dnXXNX62WtEZaXqIwIyE8SAZ2CgmDThVdOvcfdCjw1qVT/4MQFEXUUSWFQiMPpSGrS4umu9TMTu/M+04HXXd1psFbEPO9zuf5zPs88zI8wP8VAmTGAKIAACGHQpTGp1Scule13fc+CCU+mAgLQsg+ARMjV9Z0c/RZKRCwpBNxghCyT8AxmGf09fnJ+cWli4PTM5WwIIQ0NkqC0clmT2LuKyc5b+7G03fhEYSQuoAAwWwexOdw5Ycv/ljPsYgJhpB6CwGA7c6qrlpuSl4eoh2vQu+PQvbNACajTmUrLwk1heyOmGEYofXzMVhdLle5nZV62tYW9AuhFiKQuiBguNlJDaS7ue5Jo/X5Z+WgIAqpCxSOT65mmr0nXWZaYu3Wi9mDgihEAQijxJPwgZd2VQs2mOHBk+xswy2IQShY4PPfEhh+Ml/94UvftoUBB5o9vlcfhxAAaOnq6xw/7VIvVVS1Vm5OW8Oyopb6G07/V4Rg6GF7s2Bl3+SkujQxnzmSx0rmp5OymsxadRxC2EyXLxywKpBtu331ftH9ttLbytWMJk7UOohDyN3Hy5alQ80Wiu00d93oSQ8MUE41EPVSYUcQiyilQpNbsLSmrVWr6vpTi/kWXvYEVyXR+nYFsYiyHhTSbeXNDUVXjQzd7LcL2/qm53upXOXc2x1BLKJ8nLpTXHEtzdDYbxE436VQXIuXy57fU9qdQSxCgGsPjm6UBdMURgJV1VQCUoImcwsTex8xBiFUAiOPOrKUKYKUgnX5iyHwHPpmabpWHovUfihn2rePr/Llg7e/MYdAkiRJspNkxUlWnGTFSVacZMVJVpx/nj8/OnZUNhaeqwAAAABJRU5ErkJggg=="
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pos</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,))</span>
<span class="n">pos</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([22,  5])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">pos</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[3, 11]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Moving-MNIST">Moving MNIST<a class="anchor-link" href="#Moving-MNIST"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MovingMNIST" class="doc_header"><code>class</code> <code>MovingMNIST</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/datasets/moving_mnist.py#L44" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MovingMNIST</code>(<strong><code>root</code></strong>:<code>str</code>, <strong><code>train</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>transform</code></strong>:<code>Optional</code>[<code>typing.Callable</code>]=<em><code>None</code></em>, <strong><code>target_transform</code></strong>:<code>Optional</code>[<code>typing.Callable</code>]=<em><code>None</code></em>, <strong><code>download</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <a href="/cult/core.datasets.moving_mnist.html#CommonMNIST"><code>CommonMNIST</code></a></p>
</blockquote>
<p>Moving MNIST, with MNIST digits randomly projected onto 64x64 black background</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">moving_mnist</span> <span class="o">=</span> <span class="n">MovingMNIST</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">)</span>
<span class="n">img</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">moving_mnist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">img</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAAAAACPAi4CAAABGElEQVR4nGNgGAWjYFgCZiEhobqO9VLL/n+vJ0oDCxJbjs3KRiCYgYGB4cmkwM8XDxJlACOCabiXH8r6l/SV4dn7m0QZgASEbv/9+/fv32Pbvn8kVSsUBMzJ/vv3LDeD9iwyDWDgY5z1N4pEPUzInE//PzKkMOFSShTg3vfXjSIDGJQ/PlyQw0hYHW4Q+OHv33JJSkzQ3fX37zRpSkwQiP3zdzclBjAw/Pz704FYtSwYInohpiwM1w6Ra7n6lKd///79tY1M7RJFd//+/fv3pB952sWdrv79+/fvsUDyEqPQ6tt///79eziAkyzt5mse/f379++XVm4SNcJiITCQgeH65r89H8iyfhSMglEwCkbBKBgFo4CaAAAv5l6A/ysjTgAAAABJRU5ErkJggg=="
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target</span><span class="p">,</span> <span class="n">pos</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(5, tensor([3, 6]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">img</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">moving_mnist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">img</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAAAAACPAi4CAAABGElEQVR4nGNgGAWjYBSMglEwCkbBKBhKgFlISKiuY73Usv/f63EqYsEhLsdmZSMQzMDAwPBkUuDniwdxGsCIXdhwLz+U9S/pK8Oz9zeJcTEyELr99+/fv3+Pbfv+kVStUBAwJ/vv37PcDNqzyDSAgY9x1t8oItQx4ZL49P8jQwpOWaIA976/bhQZwKD88eGCHBzRRBwI/PD3b7kkJSbo7vr7d5o0JSYIxP75u5sSAxgYfv796YBPHldegAC9EFMWhmuHyLVcfcrTv3///tpGpnaJort///79e9KPPO3iTlf//v3791ggeYlRaPXtv3///j0cwEmWdvM1j/7+/fv3Sys3EYqxxUJgIAPD9c1/ez6QZf0oGAUDAgDKWl6AUF8uYAAAAABJRU5ErkJggg=="
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target</span><span class="p">,</span> <span class="n">pos</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(5, tensor([15, 29]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Moving-FashionMNIST">Moving FashionMNIST<a class="anchor-link" href="#Moving-FashionMNIST"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MovingFashionMNIST" class="doc_header"><code>class</code> <code>MovingFashionMNIST</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/datasets/moving_mnist.py#L76" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MovingFashionMNIST</code>(<strong><code>root</code></strong>:<code>str</code>, <strong><code>train</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>transform</code></strong>:<code>Optional</code>[<code>typing.Callable</code>]=<em><code>None</code></em>, <strong><code>target_transform</code></strong>:<code>Optional</code>[<code>typing.Callable</code>]=<em><code>None</code></em>, <strong><code>download</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <a href="/cult/core.datasets.moving_mnist.html#CommonFashionMNIST"><code>CommonFashionMNIST</code></a></p>
</blockquote>
<p>Moving MNIST, with MNIST digits randomly projected onto 64x64 black background</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">moving_fasionmnist</span> <span class="o">=</span> <span class="n">MovingFashionMNIST</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">img</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">moving_fasionmnist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">img</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAAAAACPAi4CAAACM0lEQVR4nO2RvU8UQRjGn5nZnd3b2+OQLw+UeBhBaYwGMZIYCiImWBliMLFSY2Ptf2ChCZ2Nlf8DiYlGY7QEIiQaMFIoGHJw8QLCXXQ/mJ2ZtcDe2crC/ZVP3veX550BcnJy/kMIUJoCiAUAhByGVgYBVafuRUH8XoJQIsFUVgFTE1e2HG/yWSNV8HWYuYHAaJXR1+dnl1fXLo7OL7QAgJjvk3Rytj3RWPoqSCVZuvH0XSYBAdLFKogUiPWHL3Jq4Fi2E1IA+72RY/txQV8eoz2vkE0AAB6jYWuvqgn1lO4/zKjpMmHw+2Jhi6CsnWLAV5wL2QQpw81e6qLYL5xEu53PP1vZBJbAp5h73uDJmHm+2rr1YvEwN+hOSaIhgZdBxNMd5iZINDvbglkDlkpxoIHxJ8vRD6llECgXIXgw/cdv0L6jb6h3+nRMk0Ld5p3Cm/fHdctuDJsJxh52tyvWlJ4g0drMculIFRuln2HBb/OMBGyhT6oQLALKXbev3q/H3zYGO4Vd4uqEkeDu43Xfd2CXa/VuWrnuDhRHRqigHMS+VAP+/guNWltc83nb3qYfxXJutdohmokStiZ8yEiwndaKXc3dHcux3RLdHQ5q+85uIpNCpXXurYng49yd+kbsc5ezA5WG37WyYl80m4kcaBi9AXDtwdGdpmLcYiS1bW4TkAa4rqzMGAmoBiYe9ZQpsxRppNv6F0OahPTN2jwMGwAAznTvH98U62bDOTk5OTk5/5DfJEzdpYqHUu8AAAAASUVORK5CYII="
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target</span><span class="p">,</span> <span class="n">pos</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(9, tensor([31, 12]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">img</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">moving_fasionmnist</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">img</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAAAAACPAi4CAAACQElEQVR4nO2Uz2sTQRTH38zszm42m6Y2TU2ixURstRdRasWC9FCsUE9SpIInFS+e/Q88KPTmxZP/Q0FQFNFjWmxAacUctJGSNhgSmwTdH52dmfXizUnZHJX9XN93Prz3ZhiAmJiYmJiYmJh/CgSQWgRAGgAAQsqMdpgAi1P3PMd/zwFhxIGIQQVEzF/ZNayFZ81QgC3dgTtgMFMk+PX5lcpW9eJMea2nyKgH+1MLF1aGAwkbXxnKBRs3nr4bSIAAwvUiIM7Alx++8MXSscFGCAGgk/cM3fYT8vIsHnuljB26A7AIdnv7RYmwJeS4MoL7HkYE7ILPdOakpZF06KZxYTBBSOBmHpuQHGdGIM3M88/KbvsLNAaffGpZEyd9Ytli99aLdWVM1TtGgQQO8NLxaNgiZgCBJGdVr0DVAQk5O5AAc08q3g8uueMIE1ygzpJSoHwHI4XJ/NJpHweJhk4zzCrbc7KnN6eiCWYfZocF6XKLIa+6XEkdKUIt9dNN2ENWJAFZK3DhAvEA0qO3r95v+N9qExmmp6g4EUlw9/G2bRugp+uNLM5dN0vJ6WnMMAWkX6orBH/dQrM+5NdtOrS/Y3s+X90qjrBuIJguEZ2MJNgL68nRbrulGbqZwu0pp94x2gEPErneubdRBB9X7zRqvk1NSg5E6H6XQvNt1u0GvNSMtAOAaw+OtrqCUI2gUNepjgA1gcrc5nIkAZYA84/G0phoAjXDPfmLQBi4+E21rDrf90M5k+0c32Hbfaox/xu/AaGy3aWyxtK1AAAAAElFTkSuQmCC"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">target</span><span class="p">,</span> <span class="n">pos</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(9, tensor([16, 31]))</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">img</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">pos</span> <span class="o">=</span> <span class="n">moving_fasionmnist</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
<span class="n">img</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAAAAACPAi4CAAACJklEQVR4nO2Su24TQRSG/7nurtc3ItsJMciKiJIoQgqRUnARSESioAQJHoACAQVCNLwFtLwKL4AogIYuRQQK5G4sJ84mO7MzQ5MitoXW0+9XzZHmfDo3oKCgoKDgP8Tvv7w6fz759GaSDDIUfbzH9pYPtzaOpm7L6nZ56/mmn2D9XbdKomZp99ta2N9r/a0fP8oV0IvBg59Ku8OdzXT5rNtra/oHd/wEswraBqrbO+raUnJsmLubK+AXZdV+PwTnZa4E5VScwi54VTBHI91TJSpZGGoQ65KTtlcFM6klv9iAxJnVPLFqp1TpNg88KmjsBA/ZdurOktM0sXrv5vUESz4tNMv3O2v9plXUyiicVsnKqlzJEwzdQefD62ftypEEJVk8bZ6+bb9IvQQAHr/8rTjhFMkcW89LHm2BMIEfA0cFrCUuqQGMeQmcyTCAEhkDdeGJBqzxEgAMItPccEJsZDfGG8wVAG0dIs7ghCa44i9wuKUlTQMYYRC1xvS5AotrmZTgDAg1FuE8BdTxVuAIAuqooXoR1lNAUO1GSmoKThjn87D5QxgRXK24QDoZEBchU2KCIYz8WKolZcV5BBUHLqxNsIYRwVSgaxl3VCQ1zsRMbvpYC3OKxH2JqlGViJKKfwUmjZR2cdNKUMOc/wyUEfs2FabnBtTibII98uFwoa7rl2SjOt9a/VwhKjd9RGDxtbGfHpjZy9+Djktu7E5ySQUFBQXn/AOIsM0ztIhAwwAAAABJRU5ErkJggg=="
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Static-MNIST">Static MNIST<a class="anchor-link" href="#Static-MNIST"> </a></h2><p>Just adding padding around MNIST - like Moving MNIST but with fixed location</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">22</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([22,  5])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FixedMNIST" class="doc_header"><code>class</code> <code>FixedMNIST</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/datasets/moving_mnist.py#L108" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FixedMNIST</code>(<strong><code>root</code></strong>:<code>str</code>, <strong><code>train</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>transform</code></strong>:<code>Optional</code>[<code>typing.Callable</code>]=<em><code>None</code></em>, <strong><code>target_transform</code></strong>:<code>Optional</code>[<code>typing.Callable</code>]=<em><code>None</code></em>, <strong><code>download</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <a href="/cult/core.datasets.moving_mnist.html#CommonMNIST"><code>CommonMNIST</code></a></p>
</blockquote>
<p>MNIST where data path is fixed</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fixed_mnist</span> <span class="o">=</span> <span class="n">FixedMNIST</span><span class="p">(</span><span class="n">DATA_PATH</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fixed_mnist</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAABACAAAAACPAi4CAAABGElEQVR4nGNgGAWjYBSMglEwcgCzkJBQXcd6qWX/v9djV8GCW7Mcm5WNQDADAwPDk0mBny8exK6KEad+w738UNa/pK8Mz97fJMbFyEDo9t+/f//+Pbbt+0dStUJBwJzsv3/PcjNozyLTAAY+xll/owgpYsIj9+n/R4YUfAoIA+59f90oMoBB+ePDBTm4Y4oIEPjh799ySUpM0N319+80aUpMEIj983c3JQYwMPz8+9MBpySevAABeiGmLAzXDpFrufqUp3///v21jUztEkV3//79+/ekH3naxZ2u/v379++xQPISo9Dq23///v17OICTLO3max79/fv375dWbkIqccRCYCADw/XNf3s+kGX9KBgFo2AUjAIyAQCrKF6AJ66XTgAAAABJRU5ErkJggg=="
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>


