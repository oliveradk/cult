---

title: Models


keywords: fastai
sidebar: home_sidebar

summary: "Pytorch Models used for encoders, decoders, and classifiers. See Section A.1 of <a href='https://arxiv.org/pdf/1808.06508.pdf'>Aachille et al.</a> for details"
description: "Pytorch Models used for encoders, decoders, and classifiers. See Section A.1 of <a href='https://arxiv.org/pdf/1808.06508.pdf'>Aachille et al.</a> for details"
nb_path: "02a_core.models.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: 02a_core.models.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Encoders">Encoders<a class="anchor-link" href="#Encoders"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Encoder-Architecture-From-Paper">Encoder Architecture From Paper<a class="anchor-link" href="#Encoder-Architecture-From-Paper"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Encoder" class="doc_header"><code>class</code> <code>Encoder</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L18" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Encoder</code>(<strong><code>latents</code></strong>=<em><code>10</code></em>, <strong><code>device</code></strong>=<em><code>'cpu'</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">encoder</span> <span class="o">=</span> <span class="n">Encoder</span><span class="p">(</span><span class="n">latents</span><span class="o">=</span><span class="n">latents</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">final</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">mm_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">mu</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">sigma</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="FC-Encoder">FC Encoder<a class="anchor-link" href="#FC-Encoder"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FCEncoder" class="doc_header"><code>class</code> <code>FCEncoder</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L49" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FCEncoder</code>(<strong><code>latents</code></strong>:<code>int</code>, <strong><code>device</code></strong>=<em><code>'cpu'</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fc_encoder</span> <span class="o">=</span> <span class="n">FCEncoder</span><span class="p">(</span><span class="n">latents</span><span class="o">=</span><span class="n">latents</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">final</span> <span class="o">=</span> <span class="n">fc_encoder</span><span class="p">(</span><span class="n">mnist_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">mu</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">sigma</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="CNN-Encoder">CNN Encoder<a class="anchor-link" href="#CNN-Encoder"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CNNEncoder" class="doc_header"><code>class</code> <code>CNNEncoder</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L68" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CNNEncoder</code>(<strong><code>latents</code></strong>:<code>int</code>, <strong><code>device</code></strong>=<em><code>'cpu'</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cnn_encoder</span> <span class="o">=</span> <span class="n">CNNEncoder</span><span class="p">(</span><span class="n">latents</span><span class="o">=</span><span class="n">latents</span><span class="p">)</span>
<span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">final</span> <span class="o">=</span> <span class="n">cnn_encoder</span><span class="p">(</span><span class="n">mnist_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">mu</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">))</span>
<span class="k">assert</span> <span class="n">sigma</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Environmental-Inference-Network">Environmental Inference Network<a class="anchor-link" href="#Environmental-Inference-Network"> </a></h2><p>NOTE: not sure if this receives the $\mu$'s or the layer before the $\mu's$ - I think the layer before?</p>
<p>Section A.1: "We attach an additional fully connected layer to the last layer of the encoder (gradients to the encoder are stopped)."</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EnvironmentInference" class="doc_header"><code>class</code> <code>EnvironmentInference</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L94" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EnvironmentInference</code>(<strong><code>max_environmnets</code></strong>:<code>int</code>, <strong><code>input_dim</code></strong>:<code>int</code>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">final</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">mm_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env_inf</span> <span class="o">=</span> <span class="n">EnvironmentInference</span><span class="p">(</span><span class="n">max_environmnets</span><span class="o">=</span><span class="n">max_environments</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">256</span><span class="p">)</span>
<span class="n">env_dist</span> <span class="o">=</span> <span class="n">env_inf</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">env_dist</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">max_environments</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env_dist</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([128])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span><span class="n">env_dist</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">128</span><span class="p">)))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Environmental--Encoding">Environmental  Encoding<a class="anchor-link" href="#Environmental--Encoding"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>See "Environment index" in section A.2 - softmax is averaged across data in batch, then argmax is taken</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">avg_env_dist</span> <span class="o">=</span> <span class="n">env_dist</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">avg_env_dist</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">((</span><span class="n">max_environments</span><span class="p">,))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">env_idx</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">avg_env_dist</span><span class="p">)</span>
<span class="n">env_idx</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(11)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">F</span><span class="o">.</span><span class="n">one_hot</span><span class="p">(</span><span class="n">env_idx</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="n">max_environments</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="env_dist_to_idx" class="doc_header"><code>env_dist_to_idx</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L107" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>env_dist_to_idx</code>(<strong><code>env_dist</code></strong>:<code>Tensor</code>, <strong><code>max_environments</code></strong>:<code>int</code>)</p>
</blockquote>
<p>Converts a batch of distributions to a one-hot vector</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">_</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">final</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">mm_batch</span><span class="p">)</span>
<span class="n">env_dist</span> <span class="o">=</span> <span class="n">env_inf</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
<span class="n">env_idx</span> <span class="o">=</span> <span class="n">env_dist_to_idx</span><span class="p">(</span><span class="n">env_dist</span><span class="p">,</span> <span class="n">max_environments</span><span class="o">=</span><span class="n">max_environments</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">env_idx</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">batch_size</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">env_idx</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">int64</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Decoder">Decoder<a class="anchor-link" href="#Decoder"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Decoder-Architecture-From-Paper">Decoder Architecture From Paper<a class="anchor-link" href="#Decoder-Architecture-From-Paper"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Decoder" class="doc_header"><code>class</code> <code>Decoder</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L116" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Decoder</code>(<strong><code>latents</code></strong>:<code>int</code>, <strong><code>max_envs</code></strong>=<em><code>0</code></em>, <strong><code>device</code></strong>=<em><code>'cpu'</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">final</span> <span class="o">=</span> <span class="n">encoder</span><span class="p">(</span><span class="n">mm_batch</span><span class="p">)</span>
<span class="n">env_dist</span> <span class="o">=</span> <span class="n">env_inf</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
<span class="n">env_idx</span> <span class="o">=</span> <span class="n">env_dist_to_idx</span><span class="p">(</span><span class="n">env_dist</span><span class="p">,</span> <span class="n">max_environments</span><span class="o">=</span><span class="n">max_environments</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">mu</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">env_idx</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">decoder</span> <span class="o">=</span> <span class="n">Decoder</span><span class="p">(</span><span class="n">latents</span><span class="o">=</span><span class="n">latents</span><span class="p">,</span> <span class="n">max_envs</span><span class="o">=</span><span class="n">max_environments</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([128, 1, 64, 64])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rec_img</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x14e2d7640&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPsAAAD7CAYAAACscuKmAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAA57klEQVR4nO2debheVXX/v0uGHwSVMINABQsFEUKUiCIODIJIEStYRKilisUBFQGroNVHeSpTQKQQtVEUCgkRiCgiMhhDW1uLRgUZMzGYIBBGQZEhuH9/3Pc9+ewv9z25kOS9se/6Pg9P1r377LOnc7h7n7W+6xulFCUSif/7eMFodyCRSPQH+bInEgOCfNkTiQFBvuyJxIAgX/ZEYkCQL3siMSBYppc9IvaJiNkRMS8ijltenUokEssf8Xz97BGxiqQ5kvaStFDSzyW9u5Ryy/LrXiKRWF5YdRnq7ixpXinldkmKiGmS3i6p58s+ZsyYMnbsWEnSS17ykqps3rx5jb3VVltVZXPmzGnsv/qrv2rs+fPnV9f95V/+ZWPPnTu3Ktt6662Hrcc6Xo91vI+sx9+3teX1OC6p99i8j73mw+u97GUvG1EfvYzz3zYfz6ePI23L23u+89HruRppW97e812zkc4j18z72DaPm222mSTp7rvv1sMPPxwaBsvysm8qaQF+XijpNW0Vxo4dq8MPP1ySdMIJJ1Rl+++/f2NfdtllVdmee+7Z2DNmzGjsAw44oLpu+vTpjb3vvvtWZVdeeeWw9S6++OLqOtZjHUl6xzve0diXXHJJY7/tbW+rrvvhD384oj7utddeVdmPfvSjYdtiHUnaZ599Gvvqq6+uytjeRRdd1Nh//dd/PeI+fuc732nstvlgPe/jW97ylsa+6qqrGpvjkqRLL7102LYk6YorrmjsAw88sLE591L7fPzN3/zNsH30+ej1fHh7HJdUj62tjyOdRz6PPh8cmz9zp556qiTpb//2b9ULK/wDXUQcERGzImLWH/7whxXdXCKR6IFl+ct+t6TN8fNmnd9VKKVMljRZksaNG1f+8R//UVK9XZGkD3zgA429++67V2VvfvObG5tboL//+7+vrnvTm97U2P5/4O23376x+X9g/+vKe3gf2R6v467E+/h3f/d3VRl3Kd72K17xisY+9NBDG/uNb3xjdR3H5ltC1uNfvN122626jlvCww47rCrbddddG5t/Gb2t97znPY3NcUn1mm255ZaN/b73va+6jmPzv2TbbrttY3MefW25Fn4EfPe7393YnIP99tuvuo5j47gk6a1vfeuwbUnSNtts09jvfe97G3uPPfboeY/tttuuKuOa8Znw9+DlL395Y/MZlqSvfe1rkqT7779fvbAsf9l/LmnriNgyIlaXdLCky5ZSJ5FIjBKe91/2UsriiPiIpKskrSLpm6WUm5dbzxKJxHLFsmzjVUq5QtIVS70wkUiMOp63n/35YMcddyzdL4r/9m//VpW94AVLThSLFy+uym699dbG3mGHHRp7lVVWqa7jB8Dbb7+9KuOZnW398Y9/rK675ZYlnkO2JUlrrLFGYz/66KON7a4ar0ewvdmzZ/est9pqqzX2448/Xl1Ht4uf/4gnn3yysd1lxO8Da665ZlX28MMPN/add97Zs61VV13yt8I/vt52222NzXGxjlTPxx133FGV8cxO+DN74403NjbHJUlrrbVWYz/00EONzXF5W5x7SXrqqaca+6abbqrKOLYxY8Y09gMPPFBdd8899zS2f1fgnDz99NM923rlK1/Z2I899lhVtskmm0iSJk6cqN/85jfDut4yXDaRGBDky55IDAiW6cz+XBERzdb73//936syumS6boQuuu46STr55JMb++ijj66u+8Y3vtHYdINI0plnnjns/fw40astSfrkJz/Z2F//+teHrSNJX/rSlxr7Qx/6UM8+dgOMupg4cWJjH3vssY09efLk6jq6yr785S9XZWzv3HPPbWx3JzGo6dOf/nRV9q1vfauxOY8clyR95CMfaWzOh1Sv5ymnnNLYRx11VHUdx/bBD36wKuOacVz+fLDeiSeeWJVxHqdMmdLYdHdJ0umnn97YH/3oR6syjs3XjGNjW/5csY9cZ0n62Mc+Nmy9I488srruc5/7XGN//OMfr8r+4z/+Q9Kzt/dE/mVPJAYE+bInEgOCfNkTiQFBX11vr3jFK8q0adMkSddcc01VxiB/uhgk6ec//3ljM+Rx1qxZ1XV0g1x77bVVGUMsr7vuup5t/fSnP21sD4385S9/2dh01fhYSEb47//+7559/NnPflaVMeS0ewaTpPHjx1fX/dd//Vdje+go54quMo5ZqsNZvR9sj6QND9GcOXNmY7/qVa+qynhPho5yfiVp3LhxjU0ikCS9/e1v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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">decoder</span> <span class="o">=</span> <span class="n">Decoder</span><span class="p">(</span><span class="n">latents</span><span class="o">=</span><span class="n">latents</span><span class="p">,</span> <span class="n">max_envs</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span> <span class="o">=</span> <span class="n">decoder</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">rec_img</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="FC-Decoder">FC Decoder<a class="anchor-link" href="#FC-Decoder"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FCDecoder" class="doc_header"><code>class</code> <code>FCDecoder</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L156" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FCDecoder</code>(<strong><code>latents</code></strong>:<code>int</code>, <strong><code>max_envs</code></strong>=<em><code>0</code></em>, <strong><code>device</code></strong>=<em><code>'cpu'</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">final</span> <span class="o">=</span> <span class="n">fc_encoder</span><span class="p">(</span><span class="n">mnist_batch</span><span class="p">)</span>
<span class="n">env_inf</span> <span class="o">=</span> <span class="n">EnvironmentInference</span><span class="p">(</span><span class="n">max_environmnets</span><span class="o">=</span><span class="n">max_environments</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">env_dist</span> <span class="o">=</span> <span class="n">env_inf</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
<span class="n">env_idx</span> <span class="o">=</span> <span class="n">env_dist_to_idx</span><span class="p">(</span><span class="n">env_dist</span><span class="p">,</span> <span class="n">max_environments</span><span class="o">=</span><span class="n">max_environments</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">mu</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">env_idx</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fc_decoder</span> <span class="o">=</span> <span class="n">FCDecoder</span><span class="p">(</span><span class="n">latents</span><span class="o">=</span><span class="n">latents</span><span class="p">,</span> <span class="n">max_envs</span><span class="o">=</span><span class="n">max_environments</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span> <span class="o">=</span> <span class="n">fc_decoder</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([128, 1, 28, 28])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rec_img</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x14e3cbfd0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPsAAAD4CAYAAAAq5pAIAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjUuMSwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy/YYfK9AAAACXBIWXMAAAsTAAALEwEAmpwYAAAZdklEQVR4nO2de3CV1fmF1xtuchWQW4QYLkUpKAKmIoI/tQoCjqBDS9EZwCvW2mKVtkJti8U6Q62otKW0ESwgKFLRig46ImoDCEhA7kJBJsolJAgCodwC7N8fOXZSm712TMI5me71zDBJznPenM2Xs3JOvvfbe5tzDkKI/33SUj0AIURyUNiFiASFXYhIUNiFiASFXYhIqJnMB6tdu7arW7eu1zdt2pTWFxYWeh37vgBwzjnnUB/qSpiZ16Wl8d+Zp06dor5BgwbUFxQUUH/eeed53d69e2ltw4YNqQ8d11D9559/7nVHjhyhtTVr8qfnsWPHqGdjP3nyJK0NPReLi4upDz2f/vWvf3ld7dq1aS17Ph0/fhwnT54s88laqbCbWX8AkwHUADDNOTeR3b9u3bro1auX1w8bNow+3tSpU72uS5cutPab3/wm9SdOnKC+Vq1aXhf6RbJ//37qr7zySup///vfU3/bbbd53aRJk2jttddeS/0ll1xC/VVXXUX9tGnTvG7ZsmW0tnnz5tRv3ryZ+s6dO3vdzp07aW3ouRj6BRz6ZbBixQqvy8zMpLXsRS83N9frKvw23sxqAJgCYACAzgBuNTP/0RVCpJTK/M1+OYDtzrkdzrmTAOYCGFw1wxJCVDWVCXtrAKXfC+1K3PYfmNkoM8s1s9zQ30lCiLPHWT8b75zLds5lOeeyQicehBBnj8qEfTeAjFJft0ncJoSohlQm7KsAdDSzdmZWG8AwAAuqZlhCiKrGKjPrzcwGAngGJa2355xzj7P7Z2RkuAcffNDre/ToQR+P9V1ff/11WpuTk0P9TTfdRD1rQW3YsIHWhlpEHTp0oH7JkiXUs7bg9773PVr7yiuvUH/ddddR/9lnn1F/0UUXVcgB4dbcjh07qM/KyvK6VatW0domTZpQf/z4cepZ2w8A6tSp43U1atSgtayVO3nyZOzatavq++zOuYUAFlbmewghkoMulxUiEhR2ISJBYRciEhR2ISJBYRciEhR2ISIhqfPZa9WqhfT0dK+fM2cOrW/WrJnXsZ4qAMyePZv6UJ/9oYce8rrBg/n8n+uvv5760BTZUB+fzSkP9aLz8vKoD/Xhi4qKqGfXGISmx7K58ABQr1496lkvO9QH79mzJ/Wh+tDU4L59+3pd165dae3p06ep96FXdiEiQWEXIhIUdiEiQWEXIhIUdiEiQWEXIhKS2no7cuQIna75gx/8gNY/9thjXhdawfWLL76gftasWdSPHj3a695++21a26ZNG+rff/996rt37059o0aNvO7DDz+ktf369aM+dNxCP7PFixd7XWhsF154IfVXXHEF9a+++qrXffe736W17du3pz60WnGo1cuma3//+9+ntWw1Yjb1Vq/sQkSCwi5EJCjsQkSCwi5EJCjsQkSCwi5EJCjsQkRCpZaS/ro0btzY9enTx+szMjK8DuDbJod62eeffz71W7dupZ4tPXznnXfS2k8//ZT6UL941KhR1LNdXjdu3Ehr582bR31oKep169ZRv2bNGq+7/fbbae38+fOpHzhwIPWNGzf2utDU3tC04tBW1qGfKasPHVM2tffll19GYWFhmUHRK7sQkaCwCxEJCrsQkaCwCxEJCrsQkaCwCxEJCrsQkZDU+eytWrXCww8/7PXjx4+n9az/yJbmBcJzxkNb9E6YMMHr2NxkINzDHzt2LPWhZa5XrlzpdYWFhbR25syZ1LOfFwCMGTOGenbtROj/1alTJ+rffPNN6isznz3UR2fXDwDh6z769+/vdaEtm3v37u117HleqbCbWR6AIgCnAZxyzvHF24UQKaMqXtmvdc7x1fyFEClHf7MLEQmVDbsD8LaZrTazMi/gNrNRZpZrZrkHDx6s5MMJISpKZd/G93HO7TazFgAWmdkW51xO6Ts457IBZANAp06dkjfrRgjxH1Tqld05tzvxsRDAqwAur4pBCSGqngqH3czqm1nDLz8H0A8An08phEgZlXkb3xLAq4k55jUBvOCce4sVnDlzBkePHvX6Dh060AfMzc31uttuu43Wsp4rEO6zs3714cOHaW3z5s2pZ/OuAWD58uXU33jjjRWuDW2bfMcdd1D/8ccfU8+2Pp4yZQqtDY1t0KBB1LP19kPfOzSnPLRefmi76WnTpnld6JqRgoICrysuLva6CofdObcDwKUVrRdCJBe13oSIBIVdiEhQ2IWIBIVdiEhQ2IWIhKROcd23bx+effZZ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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fc_decoder</span> <span class="o">=</span> <span class="n">FCDecoder</span><span class="p">(</span><span class="n">max_envs</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">latents</span><span class="o">=</span><span class="n">latents</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span> <span class="o">=</span> <span class="n">fc_decoder</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">rec_img</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">mnist_batch</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="CNN-Decoder">CNN Decoder<a class="anchor-link" href="#CNN-Decoder"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="CNNDecoder" class="doc_header"><code>class</code> <code>CNNDecoder</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L188" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>CNNDecoder</code>(<strong><code>latents</code></strong>:<code>int</code>, <strong><code>max_envs</code></strong>=<em><code>0</code></em>, <strong><code>device</code></strong>=<em><code>'cpu'</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">final</span> <span class="o">=</span> <span class="n">cnn_encoder</span><span class="p">(</span><span class="n">mnist_batch</span><span class="p">)</span>
<span class="n">env_inf</span> <span class="o">=</span> <span class="n">EnvironmentInference</span><span class="p">(</span><span class="n">max_environmnets</span><span class="o">=</span><span class="n">max_environments</span><span class="p">,</span> <span class="n">input_dim</span><span class="o">=</span><span class="mi">64</span><span class="p">)</span>
<span class="n">env_dist</span> <span class="o">=</span> <span class="n">env_inf</span><span class="p">(</span><span class="n">final</span><span class="p">)</span>
<span class="n">env_idx</span> <span class="o">=</span> <span class="n">env_dist_to_idx</span><span class="p">(</span><span class="n">env_dist</span><span class="p">,</span> <span class="n">max_environments</span><span class="o">=</span><span class="n">max_environments</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">mu</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">env_idx</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">cnn_decoder</span> <span class="o">=</span> <span class="n">CNNDecoder</span><span class="p">(</span><span class="n">latents</span><span class="o">=</span><span class="n">latents</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_x</span> <span class="o">=</span> <span class="n">cnn_decoder</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_x</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([128, 1, 28, 28])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">rec_x</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">mnist_batch</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Vanilla-VAEs">Vanilla VAEs<a class="anchor-link" href="#Vanilla-VAEs"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Reparameterization-Trick">Reparameterization Trick<a class="anchor-link" href="#Reparameterization-Trick"> </a></h3><p>TODO: explain why you have to do this to compute gradients</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="reparam" class="doc_header"><code>reparam</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L226" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>reparam</code>(<strong><code>mu</code></strong>, <strong><code>logvar</code></strong>, <strong><code>device</code></strong>=<em><code>'cpu'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Vanilla-VAE-(From-Paper)">Vanilla VAE (From Paper)<a class="anchor-link" href="#Vanilla-VAE-(From-Paper)"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="VanillaVAE" class="doc_header"><code>class</code> <code>VanillaVAE</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L232" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>VanillaVAE</code>(<strong><code>encoder</code></strong>:<code>type</code>, <strong><code>decoder</code></strong>:<code>type</code>, <strong><code>latents</code></strong>:<code>int</code>, <strong><code>device</code></strong>:<code>str</code>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="PaperVanillaVAE" class="doc_header"><code>class</code> <code>PaperVanillaVAE</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L249" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>PaperVanillaVAE</code>(<strong><code>latents</code></strong>:<code>int</code>, <strong><code>device</code></strong>:<code>str</code>) :: <a href="/cult/core.models.html#VanillaVAE"><code>VanillaVAE</code></a></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">&#39;cuda:0&#39;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vvae</span> <span class="o">=</span> <span class="n">PaperVanillaVAE</span><span class="p">(</span><span class="n">latents</span><span class="o">=</span><span class="n">latents</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span> <span class="o">=</span> <span class="n">vvae</span><span class="p">(</span><span class="n">mm_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vvae</span><span class="o">.</span><span class="n">decoder</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Decoder(
  (linear2): Linear(in_features=24, out_features=256, bias=True)
  (linear1): Linear(in_features=256, out_features=2048, bias=True)
  (conv4): ConvTranspose2d(128, 128, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv3): ConvTranspose2d(128, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv2): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv1): ConvTranspose2d(64, 1, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (relu): ReLU()
  (sigmoid): Sigmoid()
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([128, 1, 64, 64])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">rec_img</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">mm_batch</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">rec_img</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x14e448c10&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">mu</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">logvar</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vvae</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>PaperVanillaVAE(
  (encoder): Encoder(
    (conv1): Conv2d(1, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (conv2): Conv2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (conv3): Conv2d(64, 128, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (conv4): Conv2d(128, 128, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (linear): Linear(in_features=2048, out_features=256, bias=True)
    (linear_mu): Linear(in_features=256, out_features=24, bias=True)
    (linear_logvar): Linear(in_features=256, out_features=24, bias=True)
    (relu): ReLU()
  )
  (decoder): Decoder(
    (linear2): Linear(in_features=24, out_features=256, bias=True)
    (linear1): Linear(in_features=256, out_features=2048, bias=True)
    (conv4): ConvTranspose2d(128, 128, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (conv3): ConvTranspose2d(128, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (conv2): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (conv1): ConvTranspose2d(64, 1, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
    (relu): ReLU()
    (sigmoid): Sigmoid()
  )
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="ow">not</span> <span class="n">vvae</span><span class="o">.</span><span class="n">training</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span> <span class="o">=</span> <span class="n">vvae</span><span class="p">(</span><span class="n">mm_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img_decode</span> <span class="o">=</span> <span class="n">vvae</span><span class="o">.</span><span class="n">decoder</span><span class="p">(</span><span class="n">mu</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">rec_img</span><span class="p">,</span> <span class="n">rec_img_decode</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="FC-Vanilla-VAE">FC Vanilla VAE<a class="anchor-link" href="#FC-Vanilla-VAE"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FCVAE" class="doc_header"><code>class</code> <code>FCVAE</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L254" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FCVAE</code>(<strong><code>latents</code></strong>:<code>int</code>, <strong><code>device</code></strong>=<em><code>'cpu'</code></em>) :: <a href="/cult/core.models.html#VanillaVAE"><code>VanillaVAE</code></a></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fc_vae</span> <span class="o">=</span> <span class="n">FCVAE</span><span class="p">(</span><span class="n">latents</span><span class="o">=</span><span class="n">latents</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">fc_vae</span><span class="p">(</span><span class="n">mnist_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">rec_img</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">mnist_batch</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Latent-Masking-VAEs">Latent Masking VAEs<a class="anchor-link" href="#Latent-Masking-VAEs"> </a></h2><p>The paper introduces latent masking for three reasons:</p>
<ol>
<li>Help with Environmental Inference</li>
<li>Promote cross-domain homologies </li>
<li>Prevent Catestrophic forgetting 
Latent masking is performed as follows: if the kl divergence between a latent and the standard normal prior passes some threshold $\lambda$ the the latent is masked (its value is set to 0). More formally:</li>
</ol>
<p>{% raw %}
$$ \alpha_n = KL(E_{x^{s}_{batch}}[q_{\phi}(z^s_n|x^s_{batch})] || p(z_n)) $$
{% endraw %}</p>
$$a_n = \left\{ 
  \begin{array}{ c l }
    1 &amp; \quad \textrm{if } \alpha_n &lt; \lambda \\
    0                 &amp; \quad \textrm{otherwise}
  \end{array}
\right.$$<p>(TODO: this makes me confused about the C parameter - if the c difference is taken element wise, then the KL divergence is going to be a lot higher (~C), but the $\lambda$ values in the paper range from 0 to 1 - so probably C is the sum over the batch, perhaps with C divided by batch size?)</p>
<p>Rather then estimate the KL divergence of each individual sample, the paper takes the mean and standard deviation of the distribution of latent samples in the batch:</p>
<p>{% raw %}
$$ \frac{1}{B} \sum_{b=1}^{B} q_{\phi}(z_n|x_b) $$
{% endraw %}
fit a gaussian to this distribution, and then take the KL divergence of this fitted distribution</p>
<p>Later on in Appendix A.2, the paper notes that "since atypicality is computed on a relatively small batch of B samples, \alpha_i may be a noisy estimate of atypicality". The authors try to reduce this noise by introducing two more hyerpameters $\lambda_1, \lambda_2$, such that $\alpha_n = 1 \textrm{if } \alpha_n &gt; \lambda_1$ and $\alpha_n = 0$ if $\alpha_n &lt; \lambda_0$. If $\lambda_0 &lt; \alpha_n &lt; \lambda_1$, it remains unchanged. The authors don't specify values for $\lambda_1$ or $\lambda_2$</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Exploration">Exploration<a class="anchor-link" href="#Exploration"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">latents</span> <span class="o">=</span> <span class="mi">8</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">128</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">fc_vae</span> <span class="o">=</span> <span class="n">FCVAE</span><span class="p">(</span><span class="n">latents</span><span class="o">=</span><span class="n">latents</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span><span class="p">,</span> <span class="n">_final</span> <span class="o">=</span> <span class="n">fc_vae</span><span class="o">.</span><span class="n">encoder</span><span class="p">(</span><span class="n">mnist_batch</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">reparam</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">z</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([128, 8])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lam</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">lam_1</span> <span class="o">=</span> <span class="mf">1e-4</span>
<span class="n">lam_2</span> <span class="o">=</span> <span class="mf">.85</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">std</span><span class="p">,</span> <span class="n">mean</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">std_mean</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">logvar</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">std</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">mean</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
<span class="n">logvar</span> <span class="o">=</span> <span class="n">logvar</span><span class="p">[:,</span><span class="kc">None</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">mean</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">latents</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">logvar</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">latents</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alphas</span> <span class="o">=</span> <span class="n">kl_div_stdnorm</span><span class="p">(</span><span class="n">mean</span><span class="p">,</span> <span class="n">logvar</span><span class="p">)</span>
<span class="n">alphas</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([0.0149, 0.0227, 0.0092, 0.0038, 0.0003, 0.0118, 0.0059, 0.0233],
       grad_fn=&lt;MulBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="n">alphas</span> <span class="o">&lt;</span> <span class="n">lam_1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">alphas</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([0.0149, 0.0227, 0.0092, 0.0038, 0.0003, 0.0118, 0.0059, 0.0233],
       grad_fn=&lt;IndexPutBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alphas</span><span class="p">[</span><span class="n">alphas</span> <span class="o">&gt;</span> <span class="n">lam_2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">alphas</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([0.0149, 0.0227, 0.0092, 0.0038, 0.0003, 0.0118, 0.0059, 0.0233],
       grad_fn=&lt;IndexPutBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">alphas</span> <span class="o">&lt;</span> <span class="n">lam</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alphas</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([0.0149, 0.0227, 0.0092, 0.0038, 0.0003, 0.0118, 0.0059, 0.0233],
       grad_fn=&lt;IndexPutBackward0&gt;)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">alphas</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">latents</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">latents</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Latent-Masking-VAE">Latent Masking VAE<a class="anchor-link" href="#Latent-Masking-VAE"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% raw %}
$$\bar{z}_n = \frac{1}{B} \sum_{b=1}^{B} q_{\phi}(z_n|x_b)$$
{% endraw %}</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>NOTE: the lower bound is a way of testing like "inner typicaliy" or somethign (essencially if everything is supsiciously close to the prior)</p>
<p>We want so</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="latent_mask" class="doc_header"><code>latent_mask</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L260" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>latent_mask</code>(<strong><code>z</code></strong>, <strong><code>lam</code></strong>, <strong><code>lam_1</code></strong>=<em><code>0.0001</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">a</span><span class="p">,</span> <span class="n">alphas</span> <span class="o">=</span> <span class="n">latent_mask</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">lam</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">latents</span><span class="p">])</span>
<span class="k">assert</span> <span class="n">a</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">bool</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">z</span><span class="p">[:,</span><span class="o">~</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">))</span> <span class="o">*</span> <span class="mi">5</span>
<span class="n">a</span><span class="p">,</span> <span class="n">alphas</span> <span class="o">=</span> <span class="n">latent_mask</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">lam</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="o">~</span><span class="n">a</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">z</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([128, 8])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">z</span><span class="p">[:,</span><span class="o">~</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">latents</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1.7</span>
<span class="n">a</span><span class="p">,</span> <span class="n">alphs</span> <span class="o">=</span> <span class="n">latent_mask</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">lam</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">masked_z</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">clone</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
<span class="n">masked_z</span><span class="p">[:,</span> <span class="o">~</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># assert torch.equal(masked_z[:, a], z[:,a])</span>
<span class="c1"># assert torch.equal(masked_z[:, ~a], torch.zeros([batch_size, torch.sum(~a)]))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>{% raw %}
$$q(z^s|x^s) = a^s \cdot \mathcal{N}(\mu(x), \sigma(x)) + (1-a^s) \cdot \mathcal{N}(0,I)$$
{% endraw %}</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="apply_mask" class="doc_header"><code>apply_mask</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L272" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>apply_mask</code>(<strong><code>a</code></strong>, <strong><code>z</code></strong>, <strong><code>mu</code></strong>, <strong><code>logvar</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="LatentMaskVAE" class="doc_header"><code>class</code> <code>LatentMaskVAE</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L280" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>LatentMaskVAE</code>(<strong><code>encoder</code></strong>:<code>type</code>, <strong><code>decoder</code></strong>:<code>type</code>, <strong><code>latents</code></strong>:<code>int</code>, <strong><code>device</code></strong>:<code>str</code>, <strong><code>lam</code></strong>:<code>float</code>) :: <a href="/cult/core.models.html#VanillaVAE"><code>VanillaVAE</code></a></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">lm_vae</span> <span class="o">=</span> <span class="n">LatentMaskVAE</span><span class="p">(</span><span class="n">FCEncoder</span><span class="p">,</span> <span class="n">FCDecoder</span><span class="p">,</span> <span class="n">latents</span><span class="o">=</span><span class="n">latents</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="n">lam</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span><span class="p">,</span> <span class="n">_mu</span><span class="p">,</span> <span class="n">_logvar</span><span class="p">,</span> <span class="n">_alphas</span> <span class="o">=</span> <span class="n">lm_vae</span><span class="p">(</span><span class="n">mnist_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alphas</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([10.2843,  8.2969,  9.2901, 12.4226, 10.3024, 11.1031, 12.6271, 11.6726])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">rec_img</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Environmental-Inference-VAE">Environmental Inference VAE<a class="anchor-link" href="#Environmental-Inference-VAE"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Formal-Setup">Formal Setup<a class="anchor-link" href="#Formal-Setup"> </a></h3><p>To infer the environment, you take the most likely environment, reconstruct the image conditional on all previously seen enviornments. If the reconstruction loss is below some threshold and the latent mask is the same as it is for that environment typically, then it is classified as that environment. Else it is classified as a new environment:</p>
$$s = \left\{ 
  \begin{array}{ c l }
    \hat{s} &amp; \quad \textrm{if } E_{z^{\hat{s}}}[p_{\theta}(x^{s}_{batch}|z^{\hat{s}, \hat{s}})] \leq \kappa L_{\hat{s}} \land a^s = a^{\hat{s}} \\
    s_{r+t}                 &amp; \quad \textrm{otherwise}
  \end{array}
\right.$$<p>Where $\hat{s} = \argmax_{s} q(s|x^s_{batch})$ is the output of the auxiliary classifier trained to output the most likely environment, $L_{\hat{s}}$ is the average reconstruction loss on $\hat{s}$ previously, and $\kappa$ is a hyper parameter.</p>
<p>Also note that the comparision $a^s = a^{\hat{s}}$ is only taken on "used" latent variables. To calculate whether a variable $z_n$ is used, the paper finds the maximum amount of noise to add to $z_n$ without changing the reconstruction performance of the network, solving the following optimization problem:</p>
<p>{% raw %}
$$\Sigma = \argmin_{\Sigma = \textrm{diag}(\sigma_1, ..., \sigma_N)} E_{\epsilon \sim \mathcal{N}(0, \sigma)}[-\log(p_{\theta}(x|z^{\epsilon}, s)] - log|\Sigma|$$
{% endraw %}</p>
<p>with $z^{\epsilon}_n = (1 - \delta_{nm})z_n + \delta_{nm}(z_n + \epsilon)$. We then define the mask $u^s$ as</p>
$$ u_n^s = \left\{ 
  \begin{array}{ c l }
    1 &amp; \quad \textrm{if } \sigma_n' &lt; T \\
    0                &amp; \quad \textrm{otherwise}
  \end{array}
\right.$$<p>Three possible methods:</p>
<ol>
<li>actually just do SGD - I'll start with this, but it seems prohibitely slow to do sgd in every batch of this process? idk I guess you only have 24 parameters...</li>
<li>Some special solver that does it faster</li>
<li>Prescify some discrete set or something
So I guess we could just take a discrete set for each variable ([0,1,2,3,4,5] or something), calculate the loss </li>
</ol>
<p>The enviornment detector itself is trained to predict the current enviornment from the current data, and past enviornments using past data. Formally, this loss function is given by:</p>
<p>{% raw %}
$$\mathcal{L}_{\textrm{env}} = E_{x}[-log(q_{\psi}(\hat{s}|x))] + E_{\hat{s} \neq s &lt;m} E_{x' \sim p_{\theta'}(x'|z',s)}[-\log q_{\psi}(s|x')]$$
{% endraw %}</p>
<p>(Note that expected negative likelihood is just cross entropy loss). Past environments are sampled using monte-carlo methods. No mention of optimizer used for environmental classifier (I think this is maximized with the rest of of the model even though gradients are stopped)</p>
<p>Putting it all together, we have:</p>
<p><img src="/cult/assets/env_inf_alg.png" alt="enf_inf_alg"></p>
<p>Note that this algorithm doesn't use the auxilary environmental inference network - rather it performs <a href="https://arxiv.org/abs/1805.09190">analysis by synthesis</a>, determing the environment by seeing which best fits the data. I like this approach better, and it doesn't seem less efficient? The auxilary network requires <em>more</em> generation to prevent catastrophic forgetting 
Other details:
  max_envs = 7</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Used-vs-Unused-Variables">Used vs Unused Variables<a class="anchor-link" href="#Used-vs-Unused-Variables"> </a></h3><p>{% raw %}
$$\Sigma = \argmin_{\Sigma = \textrm{diag}(\sigma_1, ..., \sigma_N)} E_{\epsilon \sim \mathcal{N}(0, \sigma)}[-\log(p_{\theta}(x|z^{\epsilon}, s)] - log|\Sigma|$$
{% endraw %}</p>
<p>with $z^{\epsilon}_n = (1 - \delta_{nm})z_n + \delta_{nm}(z_n + \epsilon)$</p>
$$ u_n^s = \left\{ 
  \begin{array}{ c l }
    1 &amp; \quad \textrm{if } \sigma_n' &lt; T \\
    0                &amp; \quad \textrm{otherwise}
  \end{array}
\right.$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Exploration-(gradient-based)">Exploration (gradient based)<a class="anchor-link" href="#Exploration-(gradient-based)"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">((</span><span class="mi">10</span><span class="p">,))</span>
<span class="n">params</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">params</span><span class="o">.</span><span class="n">requires_grad</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>True</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="n">params</span><span class="p">],</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">AbsDev</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="c1">#(x * e).pow(2).sqrt().sum()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">abs_dev</span> <span class="o">=</span> <span class="n">AbsDev</span><span class="p">()</span>
<span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">abs_dev</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">epochs</span><span class="o">=</span><span class="mi">10000</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">abs_dev</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
    <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">1000</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">pass</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">params</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>tensor(0.2870, grad_fn=&lt;SumBackward0&gt;)
tensor(0.0291, grad_fn=&lt;SumBackward0&gt;)
tensor(0.0471, grad_fn=&lt;SumBackward0&gt;)
tensor(-0.0020, grad_fn=&lt;SumBackward0&gt;)
tensor(-0.0184, grad_fn=&lt;SumBackward0&gt;)
tensor(-0.0073, grad_fn=&lt;SumBackward0&gt;)
tensor(0.0295, grad_fn=&lt;SumBackward0&gt;)
tensor(-0.0254, grad_fn=&lt;SumBackward0&gt;)
tensor(0.0327, grad_fn=&lt;SumBackward0&gt;)
tensor(-0.0202, grad_fn=&lt;SumBackward0&gt;)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Exploration-(GA-Based)">Exploration (GA Based)<a class="anchor-link" href="#Exploration-(GA-Based)"> </a></h4>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="k">def</span> <span class="nf">quadratic</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">10</span> <span class="o">*</span> <span class="p">(</span><span class="n">x2</span> <span class="o">+</span> <span class="mi">2</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>

<span class="n">optimizer</span> <span class="o">=</span> <span class="n">CMA</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">sigma</span><span class="o">=</span><span class="mf">1.3</span><span class="p">)</span>

<span class="k">for</span> <span class="n">generation</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">solutions</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">optimizer</span><span class="o">.</span><span class="n">population_size</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">ask</span><span class="p">()</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">quadratic</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">solutions</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">x</span><span class="p">,</span> <span class="n">value</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;#</span><span class="si">{</span><span class="n">generation</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2"> (x1=</span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, x2 = </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
    <span class="n">optimizer</span><span class="o">.</span><span class="n">tell</span><span class="p">(</span><span class="n">solutions</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>#0 263.82207186468344 (x1=0.4376982542428074, x2 = -0.39607767760289275)
#0 419.4244349377686 (x1=1.7014145502018039, x2 = 0.043864258622233)
#0 2281.409810678941 (x1=0.9987805166239593, x2 = 2.7722163941488422)
#0 224.74214824148285 (x1=0.5971517947517759, x2 = -0.5202416793813314)
#0 116.81883953102569 (x1=0.18572879484201488, x2 = -0.9564545188883989)
#0 1567.9062171003754 (x1=-0.39978331401565215, x2 = 1.9450572752725865)
#1 28.39298276394883 (x1=0.11327268762242224, x2 = -2.4478815489381334)
#1 508.8600478098729 (x1=0.2858763729463076, x2 = 0.23940523520630796)
#1 479.2967879222815 (x1=-0.8345701000448775, x2 = 0.15544162544505824)
#1 222.84433179862353 (x1=-0.049884202299883496, x2 = -0.5386905250728539)
#1 3.637101732390163 (x1=1.3583335390133982, x2 = -2.0970583825984077)
#1 432.1046709170211 (x1=0.7933964120575749, x2 = 0.06696775863268078)
#2 678.1031878278429 (x1=2.699470696680546, x2 = -4.6038680265437595)
#2 11.112119795292141 (x1=0.7614248871681883, x2 = -1.7529999745040057)
#2 12.831651996222359 (x1=2.00882197738125, x2 = -1.6557730672405202)
#2 421.60089202219103 (x1=1.0375940697686379, x2 = 0.04389298885040427)
#2 222.1908546939239 (x1=-0.681541160839483, x2 = -0.5555723992703248)
#2 28.790224105721084 (x1=0.6979446334670188, x2 = -2.484672726642812)
#3 19.386594689754666 (x1=0.8859796611001076, x2 = -1.6137680399491485)
#3 200.4249041348133 (x1=0.5921659391580091, x2 = -0.604911331598373)
#3 16.422405146780093 (x1=0.05348976729659238, x2 = -1.7217827720044245)
#3 18.925218477313667 (x1=-0.2425482017265037, x2 = -2.2900189586353603)
#3 94.850854399321 (x1=3.416310363544082, x2 = -1.02697615609623)
#3 449.5871753473614 (x1=1.0926324323055314, x2 = 0.11175075306975768)
#4 253.31268914984787 (x1=-1.9196388063881973, x2 = -0.486362516437548)
#4 43.891168945893725 (x1=-2.0388726575282767, x2 = -2.4301270892086158)
#4 14.83938120953335 (x1=1.2209356988636484, x2 = -1.6583230850356498)
#4 4.2342712881064175 (x1=1.0437887907511072, x2 = -1.9361635689503711)
#4 83.15157186393576 (x1=0.8807565958122335, x2 = -2.8869068680405086)
#4 13.722975770136571 (x1=0.3262273371662034, x2 = -2.256396480428637)
#5 23.406848299486885 (x1=1.4325232577994476, x2 = -1.5422897754894782)
#5 7.770714857755356 (x1=1.177136354063779, x2 = -1.7890999529141953)
#5 13.902146806007691 (x1=2.2086783095888873, x2 = -1.6356381360749648)
#5 216.90518218432203 (x1=1.6380446344409862, x2 = -0.5335407957718461)
#5 6.588642529682598 (x1=1.346778784782037, x2 = -1.8036456737620523)
#5 5.766306064886914 (x1=1.1431431300195214, x2 = -2.152262557094422)
#6 14.118387898736396 (x1=0.49115502254825993, x2 = -1.7202843447739906)
#6 29.917171762537638 (x1=1.1514439697295804, x2 = -2.5147816271535777)
#6 47.710343111712184 (x1=1.3641362537857467, x2 = -1.3289240511273404)
#6 7.156311285940081 (x1=0.5203524427552485, x2 = -1.8996177666222644)
#6 101.8540155765435 (x1=0.8759518624298618, x2 = -1.0133773006572961)
#6 10.569491409392853 (x1=0.07909270533336343, x2 = -1.8572487483292675)
#7 15.749319474760508 (x1=-0.5143884242157277, x2 = -2.1843473210681132)
#7 8.28027774287089 (x1=0.41291550469697347, x2 = -1.874013034125209)
#7 10.304946108029105 (x1=0.01249688733923654, x2 = -2.1174636650148186)
#7 5.757973555210817 (x1=1.293936028365925, x2 = -1.831259984594555)
#7 21.049584555128256 (x1=-0.1129461662166037, x2 = -1.6629666081622534)
#7 15.986654493506183 (x1=1.6642779567656119, x2 = -2.376862058540309)
#8 1.0945588499263028 (x1=1.9565561508510738, x2 = -2.0076051190651927)
#8 3.9353084666518487 (x1=1.0174720352757307, x2 = -1.9930061914966912)
#8 24.377102221845803 (x1=1.027158281432041, x2 = -1.5473964452711002)
#8 20.358337411360374 (x1=0.31089100550010007, x2 = -2.362312437366703)
#8 9.18168018237006 (x1=1.1390807337444666, x2 = -2.239137192148127)
#8 6.466126545351349 (x1=0.8383431551212136, x2 = -2.133916624447454)
#9 24.767641559389755 (x1=1.2768746472730932, x2 = -2.4668884296936424)
#9 1.068770213359388 (x1=2.0720640581281753, x2 = -2.0455746751103985)
#9 13.59101666696497 (x1=0.7695922865272217, x2 = -1.7064646852822287)
#9 2.182827598241506 (x1=1.7285829731016173, x2 = -2.0752546571286046)
#9 0.17006166149487206 (x1=3.350738711170239, x2 = -2.0216896330032372)
#9 2.7527632517993093 (x1=1.3412819944646233, x2 = -2.0037654082276046)
#10 44.41580461702337 (x1=4.1428631200640424, x2 = -1.343420465550282)
#10 35.97651434258213 (x1=1.4571642413440797, x2 = -1.4203779493118405)
#10 1.3816109377151982 (x1=2.809231075538713, x2 = -2.1159835400035316)
#10 22.396397937077012 (x1=3.642607314552055, x2 = -1.5311348405312972)
#10 7.030351304785853 (x1=1.4000074079580485, x2 = -1.788567386380513)
#10 0.8318857957618767 (x1=3.1794434878769406, x2 = -1.9105748452380185)
#11 21.892094232225876 (x1=0.8817826902445254, x2 = -1.5828040069598204)
#11 40.29116301742194 (x1=3.0727124529208845, x2 = -2.634711555878827)
#11 17.933544831884394 (x1=0.2953501131908358, x2 = -1.674140922764647)
#11 9.038251796900246 (x1=3.46274206954661, x2 = -1.7029457696989998)
#11 2.635432178633665 (x1=2.08084226296519, x2 = -1.8661873984602828)
#11 11.11687063105616 (x1=5.974259831362815, x2 = -1.8493132691111192)
#12 94.46877750831275 (x1=1.4930126280085765, x2 = -1.0398033192674996)
#12 55.25603919362262 (x1=4.226542341539346, x2 = -1.2668449476540873)
#12 4.183814545381681 (x1=2.929913593038961, x2 = -1.795576360443784)
#12 1.1315419475008837 (x1=3.6377673210052475, x2 = -2.0851348807339667)
#12 0.07049962542570498 (x1=3.0545215769168514, x2 = -2.025985962186574)
#12 31.039872857514453 (x1=1.773877771598213, x2 = -1.4565250959010758)
#13 23.906580780444834 (x1=2.7819990675940836, x2 = -1.5115426694795646)
#13 23.45595696843705 (x1=5.093984206670351, x2 = -2.4367057030844936)
#13 5.088099658446561 (x1=4.288797346484385, x2 = -2.185124311157162)
#13 8.135063997321211 (x1=2.425213339176543, x2 = -2.279368650565174)
#13 13.319816399152536 (x1=4.125471987811197, x2 = -1.6528238314082482)
#13 29.538990337509926 (x1=4.2428884504967375, x2 = -1.4709043693515156)
#14 5.534346750417693 (x1=5.084134545749116, x2 = -1.8908794269794729)
#14 1.715746607516522 (x1=3.5067287934201286, x2 = -2.1207879355496857)
#14 3.6815391735716814 (x1=3.468783273583859, x2 = -1.8139413690263286)
#14 14.111665489530548 (x1=3.637725745982132, x2 = -2.370202260425866)
#14 33.477435568444825 (x1=4.100586758286771, x2 = -2.568032959923354)
#14 2.5358310872944765 (x1=4.545735430563804, x2 = -2.0382796376673302)
#15 7.420580333423497 (x1=2.2404757267248985, x2 = -2.261604724952158)
#15 12.373728109472141 (x1=2.94632761104582, x2 = -1.6482778456773572)
#15 42.20213401440563 (x1=2.8339368828984832, x2 = -1.3505805896376044)
#15 5.997342649486904 (x1=4.292669485363469, x2 = -2.207998756032267)
#15 1.6403978854688948 (x1=3.8700807945637914, x2 = -1.9060129106525723)
#15 15.416575220709852 (x1=3.2758361169653423, x2 = -2.3916693715021298)
#16 10.003229820540554 (x1=4.579854087492427, x2 = -2.2739943591166436)
#16 2.008630404916605 (x1=3.3394801841889685, x2 = -2.1376002765062494)
#16 0.31022900397423064 (x1=3.425389849778282, x2 = -1.9640455177092144)
#16 10.408358637522374 (x1=4.74461009977563, x2 = -2.2713797014753174)
#16 0.2705657237994323 (x1=2.639635118619453, x2 = -2.037510382038446)
#16 3.428363936367216 (x1=3.2171233941400934, x2 = -1.8161190230588193)
#17 3.244311830899443 (x1=3.5019366543162675, x2 = -2.1729847226188843)
#17 3.0399887768921405 (x1=3.866368938607637, x2 = -2.1513074234500085)
#17 2.0553981554136107 (x1=3.304123926512043, x2 = -1.8598962244357238)
#17 0.3744160111045887 (x1=2.4702085230695534, x2 = -2.030616499159186)
#17 3.8405895798998912 (x1=2.05488309559978, x2 = -1.8283217073443228)
#17 2.117351434635832 (x1=1.6911684499283341, x2 = -1.9364145135921071)
#18 4.886591439956333 (x1=0.9232296647539233, x2 = -1.9242625314261013)
#18 0.8577840333442699 (x1=2.730739122943565, x2 = -2.088616173096736)
#18 0.15255252852494744 (x1=3.3058737173992094, x2 = -1.9757113611889559)
#18 0.024558718356372716 (x1=2.8572173268896104, x2 = -2.006458967886454)
#18 1.4999664122357381 (x1=2.8739819596173697, x2 = -1.878176937087682)
#18 0.6178660389215958 (x1=2.5262391414050853, x2 = -2.0627229374140756)
#19 0.6089789587854453 (x1=2.9692667084227735, x2 = -2.077976562092354)
#19 0.15634013697854332 (x1=3.3931988856260262, x2 = -1.9958349389908496)
#19 0.16252160569437984 (x1=3.054014651168248, x2 = -2.039950472231696)
#19 0.26513455825103316 (x1=3.198231991181056, x2 = -2.0475224826711975)
#19 0.6401120867964022 (x1=3.5522818158465044, x2 = -2.0578875532978973)
#19 2.388483337803914 (x1=2.695217039511767, x2 = -1.8484879316753962)
#20 0.08250169294507392 (x1=3.136731120507978, x2 = -1.9747400923141618)
#20 0.10016604351806965 (x1=2.715572329620464, x2 = -2.0138805417187298)
#20 3.3693430328435876 (x1=3.97380037838985, x2 = -2.1555974246538603)
#20 0.24407696189845268 (x1=2.518709020009135, x2 = -2.0111516610771156)
#20 2.1931556960672127 (x1=4.225408088057478, x2 = -2.083158325728127)
#20 1.2219165357907271 (x1=4.042682492798587, x2 = -2.0367055520326356)
#21 0.8228146542282788 (x1=2.812587497155504, x2 = -1.911248030556734)
#21 0.13055090545832407 (x1=3.241890681157798, x2 = -2.0268402317105014)
#21 0.16253706907122598 (x1=3.323200231694572, x2 = -2.02409951852295)
#21 0.13676634555173964 (x1=2.778277003043415, x2 = -2.0295981854464644)
#21 0.4061699719099488 (x1=2.5566538142843096, x2 = -2.045783635888961)
#21 0.09647433118497019 (x1=3.172871472229797, x2 = -2.0258049966622886)
#22 0.2700759199661929 (x1=2.633549691044423, x2 = -1.9631502929411162)
#22 0.1841651137620882 (x1=3.209364777699429, x2 = -2.0374608467097257)
#22 0.049284104420649545 (x1=3.210284430155337, x2 = -1.992883425785608)
#22 1.3119049934330786 (x1=3.856797496415428, x2 = -2.076013356955823)
#22 0.04724709329790867 (x1=3.1956651150918782, x2 = -1.9905330807365909)
#22 0.7577229831707032 (x1=3.3296095939945034, x2 = -2.0805655322527867)
#23 0.2841745939294379 (x1=3.52835148331867, x2 = -1.992915295345324)
#23 0.03212170333477272 (x1=2.8546918474997915, x2 = -1.9895084585728555)
#23 0.8929694553552328 (x1=3.7637498129451563, x2 = -2.0556467140612518)
#23 0.07663318069269383 (x1=3.233475971344918, x2 = -1.9851264827639052)
#23 0.12069658431343502 (x1=3.339733605236377, x2 = -1.9927352482585234)
#23 0.3952202849702912 (x1=3.5780353466297865, x2 = -2.0247174883466896)
#24 0.17616684958617962 (x1=2.934550229060321, x2 = -2.041458796059476)
#24 0.3803117155750094 (x1=2.4628822215696844, x2 = -1.9696988106390043)
#24 0.07027476406788077 (x1=3.1780040958212368, x2 = -1.9803558390510705)
#24 0.29067689776865474 (x1=3.218659009876452, x2 = -1.9507186510768522)
#24 0.39878647356119035 (x1=3.243252989519195, x2 = -1.9417235504984076)
#24 0.2555605974678032 (x1=3.187119656888827, x2 = -2.0469624138512503)
#25 0.026390017781449657 (x1=3.134347402724953, x2 = -1.9908672057055308)
#25 0.04804939000105393 (x1=2.9866211566293566, x2 = -1.9781206954975443)
#25 0.01550927363036829 (x1=2.9594392477996276, x2 = -2.0117745908681823)
#25 0.04039007434716953 (x1=3.17779197979896, x2 = -2.0093702114524357)
#25 0.12966031591083002 (x1=3.3582172627542324, x2 = -2.003661568756278)
#25 0.27699921525793525 (x1=3.0548125752101845, x2 = -1.94765548769386)
#26 0.029727765541678223 (x1=2.877382182848113, x2 = -1.9878786814006955)
#26 0.009848014498899403 (x1=2.9718894382322825, x2 = -2.0095172531835623)
#26 0.03334124921358697 (x1=2.8678754320982183, x2 = -1.9873966878280531)
#26 0.017245971733037387 (x1=2.9396859042600485, x2 = -2.0116654110892456)
#26 0.0229697830298469 (x1=2.8486844915677447, x2 = -1.9991432623637602)
#26 0.021337808229623258 (x1=2.9790201676664285, x2 = -2.0144560211901057)
#27 0.09028783530723614 (x1=2.897744094829636, x2 = -2.0282544802049207)
#27 0.038179015670659656 (x1=2.8953835996400956, x2 = -2.0165028556457347)
#27 0.013767776058973287 (x1=3.05588532098913, x2 = -1.9896827295485118)
#27 0.01478024820768841 (x1=3.038110389402365, x2 = -1.9884553707607007)
#27 0.004568673455830609 (x1=2.9325514699473825, x2 = -1.9995598949037814)
#27 0.0015987981272004503 (x1=2.9763184032535563, x2 = -1.9967782301405295)
#28 0.06760149491215946 (x1=2.8827691667948865, x2 = -1.9767925816476295)
#28 0.03226855919691164 (x1=3.112501319374841, x2 = -1.9859957105371848)
#28 0.0011732597951319898 (x1=2.994671170125911, x2 = -1.9966164170361804)
#28 0.059520836649359976 (x1=2.8443379093767565, x2 = -1.9812143272166896)
#28 0.04327545941561132 (x1=3.201142485189461, x2 = -1.9946923074058318)
#28 0.0007243153693880746 (x1=2.973367282831085, x2 = -1.999612524251228)
#29 0.01363821459247215 (x1=3.0721660390859564, x2 = -1.9908183457944026)
#29 0.0006624521943137781 (x1=2.980878744327367, x2 = -1.998277125147274)
#29 0.009890669124554507 (x1=3.0467706834281487, x2 = -1.9912232282152158)
#29 0.01443379278553271 (x1=2.954483456837111, x2 = -2.0111184698066027)
#29 0.0007990104467169759 (x1=2.972699776028422, x2 = -1.9992671410925789)
#29 0.045342440227444235 (x1=3.0470550080104513, x2 = -1.979232653889199)
#30 0.0024279036037323613 (x1=2.9848817579425293, x2 = -1.9953102853382918)
#30 0.003661790479869881 (x1=2.9425762438511045, x2 = -1.9980913284472648)
#30 9.254954240952276e-05 (x1=3.001659163436288, x2 = -1.9990523886920197)
#30 0.02203300633903284 (x1=3.0578916398847205, x2 = -1.9863319480647421)
#30 0.003364347730081354 (x1=3.0567133361496563, x2 = -2.0012163273936627)
#30 0.0007810226501369741 (x1=3.0279120458337707, x2 = -2.0001392963571116)
#31 0.000705366503815147 (x1=3.0213063100040345, x2 = -1.9984144160134918)
#31 0.0029112335642752668 (x1=2.949531122208705, x2 = -1.9980917915764713)
#31 0.0021757477978348225 (x1=2.989743277016127, x2 = -2.004550326836027)
#31 0.00526201813142828 (x1=3.020818822685067, x2 = -1.9930511909269026)
#31 0.0012823138513153064 (x1=3.0141188849073943, x2 = -2.0032908523824187)
#31 0.012583042620276111 (x1=3.022672306515353, x2 = -2.010985904212922)
#32 0.0013294173239164647 (x1=2.972521459655879, x2 = -1.9976034459228447)
#32 0.0044300659895225025 (x1=3.0521150106998225, x2 = -2.004140158993662)
#32 0.0020279312209632236 (x1=2.9884333745293246, x2 = -2.004352176922167)
#32 0.004358562841657368 (x1=3.0594097302074372, x2 = -1.9971206827226982)
#32 0.0024461111338101235 (x1=3.0480148789647097, x2 = -2.0011860966731865)
#32 0.004817370524902427 (x1=2.944522822765869, x2 = -1.9958290848353926)
#33 0.001076625294618504 (x1=2.997955988981522, x2 = -2.0032748241381406)
#33 0.008244554536923576 (x1=2.9206616878528058, x2 = -2.004415865444687)
#33 0.0022319088073359224 (x1=2.999456700047756, x2 = -1.9952760041993056)
#33 0.002487869631880928 (x1=2.992334661576319, x2 = -2.0049286024578286)
#33 0.0013239893390757035 (x1=2.9650801400156452, x2 = -2.001022705811799)
#33 0.0014690636366272017 (x1=3.015381232106553, x2 = -2.003510671353903)
#34 0.0014833331810871063 (x1=3.0050271344976696, x2 = -2.0038184566251687)
#34 1.4936924321899112e-05 (x1=3.000761109516705, x2 = -2.0003789147216127)
#34 0.001054747792463606 (x1=3.0023452099914687, x2 = -2.0032392094445397)
#34 0.005344697035711915 (x1=2.941626883408433, x2 = -2.004401450096388)
#34 0.007574284079740055 (x1=2.929457816527363, x2 = -2.0050971407972047)
#34 0.003681701469257997 (x1=2.955071480478723, x2 = -2.0040781486030848)
#35 0.0004985661889942728 (x1=3.0114697826643404, x2 = -2.0019157512224375)
#35 0.00022480478400865102 (x1=2.992537138736638, x2 = -1.9986995751241519)
#35 0.0009798817599802102 (x1=2.998661098331357, x2 = -2.0031274416098497)
#35 0.0010748303997406422 (x1=3.0090703046915865, x2 = -2.0031504919814886)
#35 0.0009723825584046106 (x1=3.0127246357179986, x2 = -2.0028468688137124)
#35 0.0013754669498906248 (x1=2.963322618916336, x2 = -2.0005498787751343)
#36 0.0003505837125736066 (x1=3.0092789337392767, x2 = -1.9983737002083388)
#36 0.00010219083928383915 (x1=2.9980358428470555, x2 = -1.999008370402003)
#36 0.0021377231798119212 (x1=3.0047779054480768, x2 = -1.9954012014619673)
#36 0.0003808379573878707 (x1=2.9943079130892745, x2 = -2.0018666496832256)
#36 0.0012972185441446566 (x1=2.9797734890027296, x2 = -2.0029801120734327)
#36 0.0016389664658607952 (x1=2.980795994938557, x2 = -1.9964360518305384)
#37 0.0003660750441303653 (x1=2.993488834050642, x2 = -1.9982008897696075)
#37 0.0009670972084772492 (x1=2.986205093601521, x2 = -1.9972128908059883)
#37 1.1421430276948341e-05 (x1=3.0030775291978946, x2 = -1.9998603488520257)
#37 0.0023416676797535087 (x1=2.990057589253821, x2 = -1.9952641620083582)
#37 0.0002710745322901783 (x1=3.001855603049518, x2 = -1.998364056022925)
#37 0.0003173020729467446 (x1=3.001623447613639, x2 = -1.998226115869645)
#38 0.00025595123097221453 (x1=2.994711140539901, x2 = -1.998490102001513)
#38 3.7870351417824895e-05 (x1=3.0042425034686917, x2 = -1.9995542252167746)
#38 0.000360447361665907 (x1=3.0125968371601566, x2 = -1.9985795526928942)
#38 0.00011028409730582064 (x1=3.0101026484239677, x2 = -1.9997132842500398)
#38 1.8243390701094464e-05 (x1=3.003290215381538, x2 = -2.0002723577324804)
#38 0.00031460949746567237 (x1=3.0040639592540517, x2 = -1.998273460881859)
#39 0.0002877900371494032 (x1=2.998745062921296, x2 = -1.998308210503408)
#39 0.00022527144802295012 (x1=3.006278782033226, x2 = -1.9986367379408119)
#39 0.0002058565133729377 (x1=2.995354447886887, x2 = -1.998642519396318)
#39 5.594261490950006e-06 (x1=3.001390673692612, x2 = -1.999808681203965)
#39 0.0002776462395146326 (x1=3.0138827076934516, x2 = -2.0009215023961597)
#39 0.000157524300340468 (x1=2.9934372539867002, x2 = -1.9989301651290718)
#40 0.00017025540347566302 (x1=3.002383607426502, x2 = -1.9987171367215795)
#40 0.00013950313095405098 (x1=2.9897460235558904, x2 = -2.0005861663419005)
#40 4.6265829304800035e-05 (x1=2.999903040869749, x2 = -2.0006801207850953)
#40 9.836718997420523e-06 (x1=2.9981785017987934, x2 = -1.9997446793525697)
#40 8.939419736290617e-05 (x1=3.0023448693963255, x2 = -2.0009159464224346)
#40 5.2009343037119255e-05 (x1=2.9931949526720434, x2 = -2.0002387608406207)
#41 1.9529265151100988e-05 (x1=3.0017724598355104, x2 = -2.0004048166409945)
#41 6.222406137120405e-05 (x1=2.9921273906290056, x2 = -2.000049606759916)
#41 5.388105768634873e-05 (x1=3.000341181092101, x2 = -1.9992667561582342)
#41 6.000316491487638e-06 (x1=3.0007857125082884, x2 = -2.000232012334711)
#41 3.109989526679517e-05 (x1=2.9975002121506935, x2 = -2.000498507331694)
#41 9.803396168271117e-05 (x1=3.003734994826429, x2 = -2.0009169720569857)
#42 9.20141794191965e-05 (x1=2.9987151805747327, x2 = -2.0009505967518546)
#42 3.973361095846649e-05 (x1=3.006022411252984, x2 = -2.0001861229071984)
#42 0.00010365572448476149 (x1=3.007606103092963, x2 = -2.000676778547414)
#42 5.310688295711799e-06 (x1=3.0015452137765144, x2 = -1.9998290320883738)
#42 1.3195389568595449e-05 (x1=3.0016075306216305, x2 = -2.000325748904359)
#42 2.086121609305699e-06 (x1=3.0006651937147595, x2 = -1.9998717955175842)
#43 6.33115031731226e-06 (x1=2.9996252033049267, x2 = -1.9997511892736501)
#43 4.710864257892024e-06 (x1=3.002095062381196, x2 = -2.000056707836918)
#43 2.4850686259808113e-05 (x1=3.0037974173301825, x2 = -1.9996770401281856)
#43 3.606015489806256e-05 (x1=2.9986131194623415, x2 = -1.9994157336457374)
#43 8.326437154390332e-05 (x1=2.9970361650277098, x2 = -1.9991369817278821)
#43 2.787441057408515e-05 (x1=3.0009907169400036, x2 = -1.9994814164433876)
#44 4.1273649578017e-06 (x1=2.9983094177962406, x2 = -1.9998873369284045)
#44 1.019549703125597e-05 (x1=2.998443622366834, x2 = -1.9997211956654886)
#44 5.1221459043412155e-06 (x1=3.001359152648691, x2 = -1.9998190345341813)
#44 9.158766502903833e-07 (x1=3.0009090932164093, x2 = -2.000029904209431)
#44 1.563565582983172e-05 (x1=3.0017923584820134, x2 = -2.000352464280485)
#44 1.3891965073908683e-05 (x1=3.0037266014964845, x2 = -2.000006638042112)
#45 2.4755044944898642e-05 (x1=2.9993942773250164, x2 = -2.0004938435479573)
#45 6.580941441116352e-06 (x1=2.9974438262424368, x2 = -1.9999783396301367)
#45 1.8544339174924396e-06 (x1=3.0001793166121637, x2 = -1.9998650081680214)
#45 1.1981102591517397e-05 (x1=3.0034570945261834, x2 = -1.9999827953411686)
#45 4.537592745829488e-06 (x1=2.998105487313376, x2 = -2.0000973865712535)
#45 2.922630511219091e-06 (x1=3.001007683007158, x2 = -1.9998618983900056)
#46 3.820329656234834e-06 (x1=3.001538390529695, x2 = -2.0001205688282426)
#46 1.1545823802720703e-06 (x1=3.0007829810545905, x2 = -1.9999264117503657)
#46 3.144956098950626e-06 (x1=2.9983690447441473, x2 = -2.000069637709063)
#46 4.61293386192964e-06 (x1=3.001657964708951, x2 = -1.9998634684327417)
#46 1.9282494471280578e-06 (x1=2.9991282647282165, x2 = -2.0001080891790632)
#46 2.4235867033018352e-06 (x1=3.001553630476599, x2 = -2.00000990910969)
#47 1.5703038673313455e-06 (x1=3.00117785239112, x2 = -2.000042774713566)
#47 2.733281895383715e-06 (x1=3.0002154863292145, x2 = -2.000163916061974)
#47 5.921430191085465e-06 (x1=3.0011519242374973, x2 = -1.9997856521345534)
#47 1.7108035176049837e-06 (x1=3.0012656572612464, x2 = -2.000033002305171)
#47 1.758106339226297e-06 (x1=2.999130497792649, x2 = -2.0001001035589097)
#47 1.3535072727031417e-06 (x1=2.9992864168897806, x2 = -1.9999081138521042)
#48 7.955285021874155e-07 (x1=3.0003224697542086, x2 = -1.9999168410101187)
#48 4.697718993077107e-07 (x1=3.000683108356362, x2 = -2.0000055989934595)
#48 1.7062090950087195e-06 (x1=2.998745527051337, x2 = -1.9999635985280406)
#48 4.001853541105241e-06 (x1=3.00062487191493, x2 = -1.9998099634605915)
#48 8.959399612951874e-06 (x1=3.002206755309535, x2 = -2.0002022283515433)
#48 2.4213603178772015e-06 (x1=2.9995377964063636, x2 = -1.9998514157425598)
#49 9.004311278035646e-07 (x1=3.0009073688547585, x2 = -1.999972230792374)
#49 1.669786270204652e-06 (x1=2.9992303216120186, x2 = -1.9998962030130842)
#49 2.374113775405383e-07 (x1=3.000141674517379, x2 = -1.9999533802929368)
#49 1.6982104207720921e-06 (x1=3.0010189739019157, x2 = -2.000081234389761)
#49 9.125226406973101e-07 (x1=3.0002918054404066, x2 = -1.9999090399963915)
#49 3.4960315369354037e-07 (x1=3.0003414735849323, x2 = -1.9999517300357896)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">optimizer</span><span class="o">.</span><span class="n">population_size</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>6</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">sorted</span><span class="p">(</span><span class="n">solutions</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span> <span class="k">lambda</span> <span class="n">pair</span><span class="p">:</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="kc">True</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>array([ 3.00101897, -2.00008123])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Environment-Inference">Environment Inference<a class="anchor-link" href="#Environment-Inference"> </a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Note: likelihood not sufficient because the data may use the same generative factors as before (true in the fashion-&gt;mnist case)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EnvInferVAE" class="doc_header"><code>class</code> <code>EnvInferVAE</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L300" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EnvInferVAE</code>(<strong><code>encoder</code></strong>:<code>type</code>, <strong><code>decoder</code></strong>:<code>type</code>, <strong><code>latents</code></strong>:<code>int</code>, <strong><code>max_envs</code></strong>:<code>int</code>, <strong><code>lam</code></strong>:<code>float</code>, <strong><code>kappa</code></strong>:<code>float</code>, <strong><code>device</code></strong>:<code>str</code>, <strong><code>Tau</code></strong>:<code>float</code>=<em><code>2</code></em>, <strong><code>used_epochs</code></strong>:<code>int</code>=<em><code>100</code></em>, <strong><code>used_lr</code></strong>:<code>float</code>=<em><code>0.01</code></em>, <strong><code>used_delta</code></strong>:<code>float</code>=<em><code>0.95</code></em>) :: <code>Module</code></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="EnvInferGAVAE" class="doc_header"><code>class</code> <code>EnvInferGAVAE</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L425" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>EnvInferGAVAE</code>(<strong><code>encoder</code></strong>:<code>type</code>, <strong><code>decoder</code></strong>:<code>type</code>, <strong><code>latents</code></strong>:<code>int</code>, <strong><code>max_envs</code></strong>:<code>int</code>, <strong><code>lam</code></strong>:<code>float</code>, <strong><code>kappa</code></strong>:<code>float</code>, <strong><code>device</code></strong>:<code>str</code>, <strong><code>Tau</code></strong>:<code>float</code>=<em><code>2</code></em>, <strong><code>used_epochs</code></strong>:<code>int</code>=<em><code>100</code></em>, <strong><code>used_lr</code></strong>:<code>float</code>=<em><code>0.01</code></em>, <strong><code>used_delta</code></strong>:<code>float</code>=<em><code>0.95</code></em>) :: <a href="/cult/core.models.html#EnvInferVAE"><code>EnvInferVAE</code></a></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">envinfer_vae</span> <span class="o">=</span> <span class="n">EnvInferGAVAE</span><span class="p">(</span><span class="n">FCEncoder</span><span class="p">,</span> <span class="n">FCDecoder</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">used_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">used_lr</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span><span class="p">,</span> <span class="n">env_idx</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">alpas</span> <span class="o">=</span> <span class="n">envinfer_vae</span><span class="p">(</span><span class="n">mnist_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">alphas</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([10.2843,  8.2969,  9.2901, 12.4226, 10.3024, 11.1031, 12.6271, 11.6726])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">envinfer_vae</span> <span class="o">=</span> <span class="n">EnvInferVAE</span><span class="p">(</span><span class="n">FCEncoder</span><span class="p">,</span> <span class="n">FCDecoder</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">,</span> <span class="n">used_epochs</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">used_lr</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span><span class="p">,</span> <span class="n">env_idx</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">alphas</span> <span class="o">=</span> <span class="n">envinfer_vae</span><span class="p">(</span><span class="n">mnist_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">rec_img</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">envinfer_vae</span> <span class="o">=</span> <span class="n">EnvInferVAE</span><span class="p">(</span><span class="n">Encoder</span><span class="p">,</span> <span class="n">Decoder</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span><span class="p">,</span> <span class="n">env_idx</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">alphas</span> <span class="o">=</span> <span class="n">envinfer_vae</span><span class="p">(</span><span class="n">mm_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">rec_img</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="mi">128</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="%23">#<a class="anchor-link" href="#%23"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Generative-Replay-VAE">Generative Replay VAE<a class="anchor-link" href="#Generative-Replay-VAE"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Generative-Sampling">Generative Sampling<a class="anchor-link" href="#Generative-Sampling"> </a></h3><p>We need to sample the latents and environments independantly (because the environemt is typically determined by the reconstruction loss, which we don't have access to when sampling, because there is no ground truth image)</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor([[ 1.2307, -0.3270]])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="mi">64</span><span class="p">,))</span>
<span class="n">s</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>torch.Size([64])</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="generate_samples" class="doc_header"><code>generate_samples</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L456" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>generate_samples</code>(<strong><code>vae</code></strong>:<a href="/cult/core.models.html#EnvInferVAE"><code>EnvInferVAE</code></a>, <strong><code>batch_size</code></strong>:<code>int</code>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="n">generate_samples</span><span class="p">(</span><span class="n">envinfer_vae</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">samples</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">detach</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">squeeze</span><span class="p">())</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.image.AxesImage at 0x14e519cd0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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"
>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Generative-Replay-VAE">Generative Replay VAE<a class="anchor-link" href="#Generative-Replay-VAE"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="GenReplayVAE" class="doc_header"><code>class</code> <code>GenReplayVAE</code><a href="https://github.com/oliveradk/cult/tree/master/cult/core/models.py#L463" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>GenReplayVAE</code>(<strong><code>encoder</code></strong>:<code>type</code>, <strong><code>decoder</code></strong>:<code>type</code>, <strong><code>latents</code></strong>:<code>int</code>, <strong><code>max_envs</code></strong>:<code>int</code>, <strong><code>lam</code></strong>:<code>float</code>, <strong><code>kappa</code></strong>:<code>float</code>, <strong><code>final_size</code></strong>:<code>int</code>, <strong><code>device</code></strong>:<code>str</code>, <strong><code>Tau</code></strong>:<code>float</code>=<em><code>2</code></em>, <strong><code>used_epochs</code></strong>:<code>int</code>=<em><code>100</code></em>, <strong><code>used_lr</code></strong>:<code>float</code>=<em><code>0.01</code></em>, <strong><code>used_delta</code></strong>:<code>float</code>=<em><code>0.95</code></em>) :: <a href="/cult/core.models.html#EnvInferVAE"><code>EnvInferVAE</code></a></p>
</blockquote>
<p>Base class for all neural network modules.</p>
<p>Your models should also subclass this class.</p>
<p>Modules can also contain other Modules, allowing to nest them in
a tree structure. You can assign the submodules as regular attributes::</p>

<pre><code>import torch.nn as nn
import torch.nn.functional as F

class Model(nn.Module):
    def __init__(self):
        super().__init__()
        self.conv1 = nn.Conv2d(1, 20, 5)
        self.conv2 = nn.Conv2d(20, 20, 5)

    def forward(self, x):
        x = F.relu(self.conv1(x))
        return F.relu(self.conv2(x))

</code></pre>
<p>Submodules assigned in this way will be registered, and will have their
parameters converted too when you call :meth:<code>to</code>, etc.</p>
<p>.. note::
    As per the example above, an <code>__init__()</code> call to the parent class
    must be made before assignment on the child.</p>
<p>:ivar training: Boolean represents whether this module is in training or
                evaluation mode.
:vartype training: bool</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">envinfer_vae</span><span class="o">.</span><span class="n">decoder</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Decoder(
  (linear2): Linear(in_features=15, out_features=256, bias=True)
  (linear1): Linear(in_features=256, out_features=2048, bias=True)
  (conv4): ConvTranspose2d(128, 128, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv3): ConvTranspose2d(128, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv2): ConvTranspose2d(64, 64, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (conv1): ConvTranspose2d(64, 1, kernel_size=(4, 4), stride=(2, 2), padding=(1, 1))
  (relu): ReLU()
  (sigmoid): Sigmoid()
)</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">gen_replay_vae</span> <span class="o">=</span> <span class="n">GenReplayVAE</span><span class="p">(</span><span class="n">encoder</span><span class="o">=</span><span class="n">FCEncoder</span><span class="p">,</span> <span class="n">decoder</span><span class="o">=</span><span class="n">FCDecoder</span><span class="p">,</span> <span class="n">latents</span><span class="o">=</span><span class="n">latents</span><span class="p">,</span> <span class="n">max_envs</span><span class="o">=</span><span class="n">max_environments</span><span class="p">,</span> <span class="n">lam</span><span class="o">=</span><span class="n">lam</span><span class="p">,</span> <span class="n">kappa</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/Users/oliverdaniels-koch/NotebookProjects/lifelong_disrep/02a_core.models.ipynb Cell 153&#39;</span> in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/oliverdaniels-koch/NotebookProjects/lifelong_disrep/02a_core.models.ipynb#ch0000152?line=0&#39;&gt;1&lt;/a&gt;</span> gen_replay_vae = GenReplayVAE(encoder=FCEncoder, decoder=FCDecoder, latents=latents, max_envs=max_environments, lam=lam, kappa=1.5, device=device)

<span class="ansi-red-fg">TypeError</span>: __init__() missing 1 required positional argument: &#39;final_size&#39;</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">rec_img</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">logvar</span><span class="p">,</span> <span class="n">env_idx</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">alphas</span> <span class="o">=</span> <span class="n">gen_replay_vae</span><span class="p">(</span><span class="n">mnist_batch</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">rec_img</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">sample_batch_size</span><span class="o">=</span><span class="mi">64</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">samples</span> <span class="o">=</span> <span class="n">gen_replay_vae</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">sample_batch_size</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">Exception</span>                                 Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/Users/oliverdaniels-koch/NotebookProjects/lifelong_disrep/02a_core.models.ipynb Cell 156&#39;</span> in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/oliverdaniels-koch/NotebookProjects/lifelong_disrep/02a_core.models.ipynb#ch0000144?line=0&#39;&gt;1&lt;/a&gt;</span> samples = gen_replay_vae.sample(sample_batch_size)

<span class="ansi-green-intense-fg ansi-bold">/Users/oliverdaniels-koch/NotebookProjects/lifelong_disrep/02a_core.models.ipynb Cell 150&#39;</span> in <span class="ansi-cyan-fg">GenReplayVAE.sample</span><span class="ansi-blue-fg">(self, batch_size, increment)</span>
<span class="ansi-green-intense-fg ansi-bold">     &lt;a href=&#39;vscode-notebook-cell:/Users/oliverdaniels-koch/NotebookProjects/lifelong_disrep/02a_core.models.ipynb#ch0000138?line=9&#39;&gt;10&lt;/a&gt;</span> def sample(self, batch_size, increment=True):
<span class="ansi-green-intense-fg ansi-bold">     &lt;a href=&#39;vscode-notebook-cell:/Users/oliverdaniels-koch/NotebookProjects/lifelong_disrep/02a_core.models.ipynb#ch0000138?line=10&#39;&gt;11&lt;/a&gt;</span>     if self.m == 0:
<span class="ansi-green-fg">---&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/oliverdaniels-koch/NotebookProjects/lifelong_disrep/02a_core.models.ipynb#ch0000138?line=11&#39;&gt;12&lt;/a&gt;</span>         raise Exception(&#34;should not generate samples on current environment&#34;)
<span class="ansi-green-intense-fg ansi-bold">     &lt;a href=&#39;vscode-notebook-cell:/Users/oliverdaniels-koch/NotebookProjects/lifelong_disrep/02a_core.models.ipynb#ch0000138?line=12&#39;&gt;13&lt;/a&gt;</span>     samples = generate_samples(self.old_model[0], batch_size)
<span class="ansi-green-intense-fg ansi-bold">     &lt;a href=&#39;vscode-notebook-cell:/Users/oliverdaniels-koch/NotebookProjects/lifelong_disrep/02a_core.models.ipynb#ch0000138?line=13&#39;&gt;14&lt;/a&gt;</span>     return samples

<span class="ansi-red-fg">Exception</span>: should not generate samples on current environment</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">samples</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Size</span><span class="p">([</span><span class="n">sample_batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_text output_error">
<pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AssertionError</span>                            Traceback (most recent call last)
<span class="ansi-green-intense-fg ansi-bold">/Users/oliverdaniels-koch/NotebookProjects/lifelong_disrep/02a_core.models.ipynb Cell 157&#39;</span> in <span class="ansi-cyan-fg">&lt;cell line: 1&gt;</span><span class="ansi-blue-fg">()</span>
<span class="ansi-green-fg">----&gt; &lt;a href=&#39;vscode-notebook-cell:/Users/oliverdaniels-koch/NotebookProjects/lifelong_disrep/02a_core.models.ipynb#ch0000145?line=0&#39;&gt;1&lt;/a&gt;</span> assert samples.shape == torch.Size([sample_batch_size, 1, 28, 28])

<span class="ansi-red-fg">AssertionError</span>: </pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Classifiers-and-Regressors">Classifiers and Regressors<a class="anchor-link" href="#Classifiers-and-Regressors"> </a></h2>
</div>
</div>
</div>
</div>


